<div class="container-fluid bg-transparent userInfo" *ngIf="form">
    <form [formGroup]="form" (ngSubmit)="onSubmit()">
        <div class="row">
            <div class="col-lg-3">
                <div class="card mb-4 text-center">
                    <div class="card-body">
                        <div class="row mb-3">
                            <span>Upload Profile Image</span>
                            <div class="cursor-pointer mb-2" (click)="triggerFileUpload()">
                                <img [src]="form.get('profImage')?.value" class="rounded-circle img-fluid"
                                    alt="Profile Image" (error)="setDefaultImage()" id="profImg" />
                                <input type="file" accept="image/*" (change)="upload($event, 'profileImage')"
                                    style="display: none" #fileInput />
                            </div>
                            <div class="mb-3" *ngIf="this.user.role == 'physician' || this.user.role == 'patient'">
                                <mat-form-field appearance="outline" class="w-100">
                                    <mat-label>User Name</mat-label>
                                    <input matInput formControlName="username" placeholder="User Name"
                                        autocomplete="off">
                                    <mat-error *ngIf="submitted && f['username'].errors">
                                        <div *ngIf="f['username'].errors['required']">User Name is required</div>
                                        <div *ngIf="f['username'].errors['pattern']">Please enter a valid user name.
                                        </div>
                                    </mat-error>
                                </mat-form-field>
                            </div>
                            <div *ngIf="this.user.role == 'physician' || this.user.role == 'patient'">
                                <mat-form-field appearance="outline" class="w-100">
                                    <mat-label>Display Name</mat-label>
                                    <input matInput formControlName="displayName" placeholder="Display Name"
                                        autocomplete="off">
                                    <mat-error *ngIf="submitted && f['displayName'].errors">
                                        <div *ngIf="f['displayName'].errors['required']">Display Name is required</div>
                                        <div *ngIf="f['displayName'].errors['pattern']">Please enter a valid display
                                            name.</div>
                                    </mat-error>
                                </mat-form-field>
                            </div>
                        </div>
                        <div class="row mb-3" *ngIf="this.user.role == 'physician' || this.user.role == 'patient'">
                            <div class="col-sm-8">
                                <mat-form-field appearance="outline" class="w-100">
                                    <mat-label>Birth Date</mat-label>
                                    <input matInput [matDatepicker]="picker" placeholder="Birth Date yyyy-mm-dd"
                                        formControlName="birthDate" [min]="minDate" autocomplete="off"
                                        (dateChange)="calculateAge()" />
                                    <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                                    <mat-datepicker #picker></mat-datepicker>
                                    <mat-error *ngIf="form.get('birthDate')?.hasError('required') && submitted">
                                        Birth Date is required
                                    </mat-error>
                                    <mat-error *ngIf="form.get('birthDate')?.hasError('minAge') && submitted">
                                        Must be 18+ years
                                    </mat-error>
                                </mat-form-field>
                            </div>
                            <div class="col-sm-4">
                                <mat-form-field appearance="outline" class="w-100">
                                    <mat-label>Age</mat-label>
                                    <input matInput readonly formControlName="age" placeholder="Age"
                                        autocomplete="off" />
                                </mat-form-field>
                            </div>
                        </div>
                        <div class="row mb-3" *ngIf="this.user.role == 'physician' || this.user.role == 'patient'">
                            <mat-label>Gender</mat-label>
                            <div class="btn-group flex-wrap">
                                <input type="radio" formControlName="gender" class="btn-check " name="gender"
                                    id="option1" value="Male" autocomplete="off" />
                                <label class="btn btn-outline-secondary" for="option1" data-mdb-ripple-init><i
                                        class="bi bi-gender-male"></i>Male</label>

                                <input type="radio" formControlName="gender" class="btn-check" name="gender"
                                    id="option2" value="Female" autocomplete="off" />
                                <label class="btn btn-outline-secondary" for="option2" data-mdb-ripple-init><i
                                        class="bi bi-gender-female"></i>Female</label>

                                <input type="radio" formControlName="gender" class="btn-check" name="gender"
                                    id="option3" value="Unspicified" autocomplete="off" />
                                <label class="btn btn-outline-secondary" for="option3" data-mdb-ripple-init><i
                                        class="bi bi-gender-ambiguous"></i>Unspicified</label>
                            </div>
                            <div *ngIf="submitted && f['gender'].errors" class="invalid-feedback d-block">
                                Gender is required
                            </div>
                        </div>
                        <div class="row" *ngIf="this.user.role == 'patient'">
                            <div class="col-sm">
                                <mat-form-field appearance="outline" class="w-100 mb-3">
                                    <mat-label>Blood Group</mat-label>
                                    <mat-select formControlName="bloodGroup" placeholder="Select Blood Group">
                                        <mat-option value="A+">A positive (A+)</mat-option>
                                        <mat-option value="A-">A negative (A-)</mat-option>
                                        <mat-option value="B+">B positive (B+)</mat-option>
                                        <mat-option value="B-">B negative (B-)</mat-option>
                                        <mat-option value="AB+">AB positive (AB+)</mat-option>
                                        <mat-option value="AB-">AB negative (AB-)</mat-option>
                                        <mat-option value="O+">O positive (O+)</mat-option>
                                        <mat-option value="O-">O negative (O-)</mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </div>
                        </div>
                        <div class="row" *ngIf="this.user.role == 'patient'">
                            <mat-label>Relative Details</mat-label>
                            <div class="col-sm-6">
                                <mat-form-field appearance="outline" class="w-100 mb-3">
                                    <mat-label>Relationship</mat-label>
                                    <mat-select formControlName="relationship" placeholder="Select Relationship">
                                        <mat-option value="Mother">Mother</mat-option>
                                        <mat-option value="Father">Father</mat-option>
                                        <mat-option value="Brother">Brother</mat-option>
                                        <mat-option value="Sister">Sister</mat-option>
                                        <mat-option value="Daughter">Daughter</mat-option>
                                        <mat-option value="Son">Son</mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </div>
                            <div class="col-sm-6">
                                <mat-form-field appearance="outline" class="w-100">
                                    <mat-label>Mobile</mat-label>
                                    <input matInput placeholder="Mobile" autocomplete="off"
                                        formControlName="relationId">
                                </mat-form-field>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-9">
                <div class="card bg-danger text-center" *ngIf="userData.status ==='Rejected'">
                    <div class="row">
                        <div class="col top-warning"><i class="bi bi-exclamation-triangle-fill"></i> Your application
                            was rejected. Please resubmit with corrections.
                            <a class="warning cursor-pointer" (click)="open(content)">Show Admin Comments</a>
                        </div>
                    </div>
                </div>
                <div class="card bg-warning text-center" *ngIf="userData.status ==='Saved'">
                    <div class="row">
                        <div class="col top-warning"><i class="bi bi-exclamation-triangle-fill"></i> Your application is
                            saved. Please complete the application and submit for admin to review.
                        </div>
                    </div>
                </div>
                <div class="card bg-success text-center" *ngIf="userData.status ==='Submitted'">
                    <div class="row">
                        <div class="col top-warning"><i class="bi bi-exclamation-triangle-fill"></i> Thank you!! Your
                            application is submitted and is under review. Once approved you will be able to use the
                            application.
                        </div>
                    </div>
                </div>
                <div class="card bg-success text-center"
                    *ngIf="userData.role !=='physician' && userData.status ==='Confirm'">
                    <div class="row">
                        <div class="col top-info"><i class="bi bi-exclamation-triangle-fill"></i> Please confirm the
                            details you had shared for previous roles to use application as {{userData.role}}.
                        </div>
                    </div>
                </div>
                <ul class="nav nav-tabs">
                    <li class="nav-item " *ngIf="this.user.role == 'physician' || this.user.role == 'patient'">
                        <div class="nav-link" id="p_info" #p_info aria-current="page"
                            (click)="changeTab('p_info',p_info)"><i class="bi bi-person"></i>Personal Information</div>
                    </li>
                    <li class="nav-item" *ngIf="this.user.role == 'physician' || this.user.role == 'patient'">
                        <div class="nav-link" id="addr_info" #addr_info (click)="changeTab('addr_info', addr_info )"><i
                                class="bi bi-building"></i>Address Details</div>
                    </li>
                    <li *ngIf="this.user.role == 'physician'" class="nav-item">
                        <div class="nav-link" id="q_info" #q_info (click)="changeTab('q_info',q_info)"><i
                                class="bi bi-filetype-doc"></i>Qualification
                            Documents</div>
                    </li>
                    <li class="nav-item" *ngIf="this.user.role != 'patient'">
                        <div class="nav-link" id="hosp_info" #hosp_info (click)="changeTab('hosp_info',hosp_info)"><i
                                class="bi bi-hospital"></i>{{this.user.role === 'physician' ? 'Hospital / Clinic
                            Information' : 'Basic
                            Information'}}</div>
                    </li>
                    <li class="nav-item" *ngIf="this.user.role != 'physician' &&Â  this.user.role != 'patient' ">
                        <div class="nav-link" id="auth_per" #auth_per (click)="changeTab('auth_per',auth_per)"><i
                                class="bi bi-person"></i>Authorized Person Information</div>
                    </li>
                </ul>
                <div class="row">
                    <div *ngIf="tab ==='p_info'">
                        <div class="card mb-4">
                            <div class="card-body">
                                <p class="mb-4"><span class="text-primary font-italic me-1">Personal Information</span>
                                </p>
                                <div class="row">
                                    <div class="col-sm-4">
                                        <mat-form-field appearance="outline" class="w-100">
                                            <mat-label>First Name</mat-label>
                                            <input matInput formControlName="firstName" placeholder="First Name"
                                                autocomplete="off">
                                            <mat-error *ngIf="submitted && f['firstName'].errors">
                                                <div *ngIf="f['firstName'].errors['required']">First Name is required
                                                </div>
                                                <div *ngIf="f['firstName'].errors['pattern']">Please enter a valid first
                                                    name.</div>
                                            </mat-error>
                                        </mat-form-field>
                                    </div>
                                    <div class="col-sm-4">
                                        <mat-form-field appearance="outline" class="w-100">
                                            <mat-label>Middle Name</mat-label>
                                            <input matInput placeholder="Middle Name" autocomplete="off"
                                                formControlName="middleName">
                                            <mat-error *ngIf="submitted && f['middleName'].errors">
                                                <div>Please enter a valid middle name.</div>
                                            </mat-error>
                                        </mat-form-field>
                                    </div>
                                    <div class="col-sm-4">
                                        <mat-form-field appearance="outline" class="w-100">
                                            <mat-label>Last Name</mat-label>
                                            <input matInput formControlName="lastName" placeholder="Last Name"
                                                autocomplete="off">
                                            <mat-error *ngIf="submitted && f['lastName'].errors">
                                                <div *ngIf="f['lastName'].errors['required']">Last Name is required
                                                </div>
                                                <div *ngIf="f['lastName'].errors['pattern']">Please enter a valid last
                                                    name.</div>
                                            </mat-error>
                                        </mat-form-field>
                                    </div>
                                </div>
                                <hr>
                                <div class="row">
                                    <div class="col-sm-6">
                                        <mat-form-field appearance="outline" class="w-100">
                                            <mat-label>Mobile</mat-label>
                                            <input matInput [readOnly]="true" formControlName="mobile1"
                                                placeholder="Mobile" autocomplete="off">
                                        </mat-form-field>
                                    </div>
                                    <div class="col-sm-6">
                                        <mat-form-field appearance="outline" class="w-100">
                                            <mat-label>Mobile 2</mat-label>
                                            <input matInput formControlName="mobile2" placeholder="Mobile 2"
                                                autocomplete="off">
                                            <mat-error *ngIf="submitted && f['mobile2'].errors">
                                                <div *ngIf="f['mobile2'].invalid">Mobile number is invalid</div>
                                            </mat-error>
                                            <mat-error *ngIf="submitted && mobileSameError">
                                                Both mobile numbers are same.
                                            </mat-error>
                                        </mat-form-field>
                                    </div>
                                </div>
                                <hr>
                                <div class="row">
                                    <div class="col-sm-6">
                                        <mat-form-field appearance="outline" class="w-100">
                                            <mat-label>Email</mat-label>
                                            <input matInput formControlName="email1" placeholder="Email"
                                                autocomplete="off">
                                            <mat-error *ngIf="submitted && f['email1'].errors">
                                                <div *ngIf="f['email1'].invalid">Email is invalid</div>
                                            </mat-error>
                                        </mat-form-field>
                                    </div>
                                    <div class="col-sm-6">
                                        <mat-form-field appearance="outline" class="w-100">
                                            <mat-label>Email 2</mat-label>
                                            <input matInput formControlName="email2" placeholder="Email 2"
                                                autocomplete="off">
                                            <mat-error *ngIf="submitted && f['email2'].errors">
                                                <div *ngIf="f['email2'].invalid">Email is invalid</div>
                                            </mat-error>
                                            <mat-error *ngIf="submitted && emailSameError">
                                                Both email ids are same.
                                            </mat-error>
                                        </mat-form-field>
                                    </div>
                                </div>
                                <hr>
                                <div class="row">
                                    <div class="col-sm-6">
                                        <mat-form-field appearance="outline" class="w-100">
                                            <mat-label>Aadhar Number</mat-label>
                                            <input matInput formControlName="aadhar" placeholder="Aadhar Number"
                                                autocomplete="off">
                                            <mat-error *ngIf="submitted && f['aadhar'].errors">
                                                <div *ngIf="f['aadhar'].invalid">Aadhar is invalid</div>
                                            </mat-error>
                                        </mat-form-field>
                                    </div>
                                    <div class="col-sm-6">
                                        <mat-form-field appearance="outline" class="w-100">
                                            <mat-label>PAN</mat-label>
                                            <input matInput formControlName="pan" placeholder="PAN" autocomplete="off">
                                            <mat-error *ngIf="submitted && f['pan'].errors">
                                                <div *ngIf="f['pan'].invalid">Pan is invalid</div>
                                            </mat-error>
                                        </mat-form-field>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div *ngIf="tab =='addr_info'">
                        <div class="card mb-4">
                            <div class="card-body">
                                <p class="mb-4"><span class="text-primary font-italic me-1">Address Details</span>
                                </p>
                                <div class="row">
                                    <div class="col-sm-6">
                                        <mat-form-field appearance="outline" class="w-100">
                                            <mat-label>House / Flat Number</mat-label>
                                            <input matInput formControlName="address1" placeholder="House / Flat Number"
                                                autocomplete="off">
                                            <mat-error *ngIf="submitted && f['address1'].errors">
                                                <div *ngIf="f['address1'].errors['required']">House / Flat Number is
                                                    required</div>
                                            </mat-error>
                                        </mat-form-field>
                                    </div>
                                    <div class="col-sm-6">
                                        <mat-form-field appearance="outline" class="w-100">
                                            <mat-label>Building / Society</mat-label>
                                            <input matInput formControlName="address2" placeholder="Building / Society"
                                                autocomplete="off">
                                            <mat-error *ngIf="submitted && f['address2'].errors">
                                                <div *ngIf="f['address2'].errors['required']">Building / Society is
                                                    required</div>
                                            </mat-error>
                                        </mat-form-field>
                                    </div>
                                </div>
                                <hr>
                                <div class="row">
                                    <div class="col-12">
                                        <mat-form-field appearance="outline" class="w-100">
                                            <mat-label>Area / Locality</mat-label>
                                            <textarea matInput formControlName="area" placeholder="Area / Locality"
                                                autocomplete="off"></textarea>
                                            <mat-error *ngIf="submitted && f['area'].errors">
                                                <div *ngIf="f['area'].errors['required']">Area / Locality is required
                                                </div>
                                            </mat-error>
                                        </mat-form-field>
                                    </div>
                                </div>
                                <hr>
                                <div class="row">
                                    <div class="col">
                                        <mat-form-field appearance="outline" class="w-100">
                                            <mat-label>Pin Code</mat-label>
                                            <input matInput formControlName="pincode" placeholder="Pin Code"
                                                autocomplete="off">
                                            <mat-error *ngIf="submitted && f['pincode'].errors">
                                                <div *ngIf="f['pincode'].errors['required']">Pincode is required</div>
                                                <div *ngIf="f['pincode'].errors['pattern']">Please enter a valid 6-digit
                                                    Indian pincode.</div>
                                            </mat-error>
                                        </mat-form-field>
                                    </div>
                                    <div class="col">
                                        <mat-form-field appearance="outline" class="w-100">
                                            <mat-label>Select State</mat-label>
                                            <mat-select formControlName="state"
                                                (selectionChange)="onStateChange($event)">
                                                <mat-option>
                                                    <ngx-mat-select-search [formControl]="stateFilterCtrl"
                                                        placeholderLabel="Search state"></ngx-mat-select-search>
                                                </mat-option>
                                                <mat-option *ngFor="let state of filteredStates | async"
                                                    [value]="state.isoCode">
                                                    {{ state.name }}
                                                </mat-option>
                                            </mat-select>
                                            <mat-error *ngIf="submitted && f['state'].errors">State is
                                                required</mat-error>
                                        </mat-form-field>
                                    </div>
                                    <div class="col">
                                        <mat-form-field appearance="outline" class="w-100">
                                            <mat-label>Select City</mat-label>
                                            <mat-select formControlName="city">
                                                <mat-option>
                                                    <ngx-mat-select-search [formControl]="cityFilterCtrl"
                                                        placeholderLabel="Search city"></ngx-mat-select-search>
                                                </mat-option>
                                                <mat-option *ngFor="let city of filteredCities | async"
                                                    [value]="city.name">
                                                    {{ city.name }}
                                                </mat-option>
                                            </mat-select>
                                            <mat-error *ngIf="submitted && f['city'].errors">City is
                                                required</mat-error>
                                        </mat-form-field>
                                    </div>
                                </div>
                                <hr>
                            </div>
                        </div>
                    </div>
                    <div *ngIf="tab =='q_info'">
                        <div class="card mb-4">
                            <div class="card-body">
                                <div class="row col-sm-4">
                                    <mat-form-field appearance="outline" class="w-100">
                                        <mat-label>Speciality</mat-label>
                                        <mat-select formControlName="speciality" required>
                                            <mat-option>
                                                <ngx-mat-select-search [formControl]="specialityFilterCtrl"
                                                    placeholderLabel="Search Speciality"></ngx-mat-select-search>
                                            </mat-option>
                                            <mat-option *ngFor="let speciality of filteredSpecialities | async"
                                                [value]="speciality">
                                                {{ speciality }}
                                            </mat-option>
                                        </mat-select>
                                        <mat-error *ngIf="submitted && f['speciality'].errors">Speciality is
                                            required</mat-error>
                                    </mat-form-field>
                                </div>
                                <hr>
                                <p class="mb-4"><span class="text-primary font-italic me-1">Medical Registration</span>
                                </p>
                                <div class="row" formGroupName="medicalRegistration">
                                    <mat-form-field appearance="outline" class="col-sm-4" style="height: 30px;">
                                        <mat-label>MRC Number</mat-label>
                                        <input matInput formControlName="certificateNumber" placeholder="MRC Number">
                                        <button mat-icon-button matSuffix
                                            matTooltip="Medical Registration Certificate Number">
                                            <mat-icon>info</mat-icon>
                                        </button>
                                        <mat-error
                                            *ngIf="submitted && (certificateNumberError || f['medicalRegistration'].get('certificateNumber')?.errors)">
                                            Certificate Number is required
                                        </mat-error>
                                        <mat-error
                                            *ngIf="submitted && f['medicalRegistration'].get('certificateNumber')?.errors?.['pattern']">
                                            Please enter a valid Certificate Number.
                                        </mat-error>
                                    </mat-form-field>
                                    <div class="col-sm-4">
                                        <mat-form-field appearance="outline" class="w-100">
                                            <mat-label>Medical Council Name</mat-label>
                                            <mat-select formControlName="councilName" required>
                                                <mat-option>
                                                    <ngx-mat-select-search [formControl]="councilFilterCtrl"
                                                        placeholderLabel="Search Council"></ngx-mat-select-search>
                                                </mat-option>
                                                <mat-option *ngFor="let council of filteredCouncils | async"
                                                    [value]="council">
                                                    {{ council }}
                                                </mat-option>
                                            </mat-select>
                                            <mat-error *ngIf="submitted && councilError">Council Name is
                                                required</mat-error>
                                        </mat-form-field>
                                    </div>
                                    <div class="col-sm-4">
                                        <div class="input-group">
                                            <input class="form-control" accept=".pdf,.jpg, .png,.jpeg" type="file"
                                                id="formFile" (change)="upload($event, 'medicalRegistration')"
                                                [ngClass]="{ 'is-invalid': submitted && docError }" style="height:56px">

                                            <button *ngIf="user.medicalRegistration?.document"
                                                (click)="view(user.medicalRegistration?.document)"
                                                class="btn btn-primary" type="button">
                                                View
                                            </button>

                                            <div *ngIf="submitted && docError" class="invalid-feedback d-flex">
                                                <div> Document is required</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <hr>
                                <p class="mb-4"><span class="text-primary font-italic me-1">Qualification
                                        Documents</span>
                                </p>
                                <mat-checkbox formControlName="noDocConsentProvided" class="m-2">
                                    I confirm I am Qualified Registered Medical Practioner and do not wish to provide
                                    qualification documens or medical registration certificate copy. I take full
                                    responsibility of legal use of healthdesk as physician.
                                </mat-checkbox>
                                <div class="row mb-1" formGroupName="graduation">
                                    <span class="text-success font-italic mb-2">Graduation<i class="danger">*</i></span>
                                    <div class="col">
                                        <mat-form-field appearance="outline" class="w-100">
                                            <mat-label>Qualification</mat-label>
                                            <mat-select formControlName="name">
                                                <mat-option>
                                                    <ngx-mat-select-search [formControl]="graduationFilterCtrl"
                                                        placeholderLabel="Search Graduation"></ngx-mat-select-search>
                                                </mat-option>
                                                <mat-option *ngFor="let graduation of filteredGraduations | async"
                                                    [value]="graduation">
                                                    {{ graduation }}
                                                </mat-option>
                                            </mat-select>
                                            <mat-error *ngIf="submitted && gNameError">Qualification is
                                                required</mat-error>
                                        </mat-form-field>
                                    </div>
                                    <div class="col">
                                        <select class="form-select" id="year" formControlName="year"
                                            style="height:56px">
                                            <option value="" disabled selected>Select Year</option>
                                            <option *ngFor="let year of yearsList" [value]="year">{{ year }}</option>
                                        </select>
                                        <div *ngIf="submitted && gYearError" class="invalid-feedback d-flex">
                                            <div>Year is required</div>
                                        </div>
                                    </div>
                                    <div class="col">
                                        <mat-form-field appearance="outline" class="w-100">
                                            <mat-label>Institute Name</mat-label>
                                            <mat-select formControlName="institute">
                                                <mat-option>
                                                    <ngx-mat-select-search [formControl]="collegeFilterCtrl"
                                                        placeholderLabel="Search Institute"></ngx-mat-select-search>
                                                </mat-option>
                                                <mat-option *ngFor="let college of filteredColleges | async"
                                                    [value]="college">
                                                    {{ college }}
                                                </mat-option>
                                            </mat-select>
                                            <mat-error *ngIf="submitted && gInstituteError">Institute is
                                                required</mat-error>
                                        </mat-form-field>
                                    </div>
                                    <div class="col">
                                        <div class="input-group">
                                            <input class="form-control" accept=".pdf,.jpg, .png,.jpeg" type="file"
                                                id="formFile" (change)="upload($event, 'graduation')"
                                                [ngClass]="{ 'is-invalid': submitted && gDocError }"
                                                style="height:56px">

                                            <button *ngIf="user.graduation?.document"
                                                (click)="view(user.graduation?.document)" class="btn btn-primary"
                                                type="button">
                                                View
                                            </button>

                                            <div *ngIf="submitted && gDocError" class="invalid-feedback d-flex">
                                                <div>Give consent by checking above or Document is required</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <hr>
                                <div class="row" formGroupName="postGraduation">
                                    <span class="text-success font-italic mb-2">Post Graduation</span>
                                    <div class="col">
                                        <mat-form-field appearance="outline" class="w-100">
                                            <mat-label>Qualification</mat-label>
                                            <mat-select formControlName="name">
                                                <mat-option>
                                                    <ngx-mat-select-search [formControl]="postGraduationFilterCtrl"
                                                        placeholderLabel="Search Post Graduation"></ngx-mat-select-search>
                                                </mat-option>
                                                <mat-option *ngFor="let graduation of filteredPostGraduations | async"
                                                    [value]="graduation">
                                                    {{ graduation }}
                                                </mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                    </div>
                                    <div class="col">
                                        <select class="form-select" id="year" formControlName="year"
                                            style="height:56px">
                                            <option value="" disabled selected>Select Year</option>
                                            <option *ngFor="let year of yearsList" [value]="year">{{ year }}</option>
                                        </select>
                                    </div>
                                    <div class="col">
                                        <mat-form-field appearance="outline" class="w-100">
                                            <mat-label>Institute Name</mat-label>
                                            <mat-select formControlName="institute">
                                                <mat-option>
                                                    <ngx-mat-select-search [formControl]="collegeFilterCtrl"
                                                        placeholderLabel="Search Institute"></ngx-mat-select-search>
                                                </mat-option>
                                                <mat-option *ngFor="let college of filteredColleges | async"
                                                    [value]="college">
                                                    {{ college }}
                                                </mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                    </div>
                                    <div class="col">
                                        <div class="input-group">
                                            <input class="form-control" accept=".pdf,.jpg, .png,.jpeg" type="file"
                                                id="formFile" (change)="upload($event, 'postGraduation')"
                                                style="height:56px">
                                            <button *ngIf="user.postGraduation?.document"
                                                (click)="view(user.postGraduation?.document)" class="btn btn-primary"
                                                type="button">
                                                View
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <hr>
                                <div class="row" formGroupName="superSpecialization">
                                    <span class="text-success font-italic mb-2">Super Specialization</span>
                                    <div class="col">
                                        <mat-form-field appearance="outline" class="w-100">
                                            <mat-label>Qualification</mat-label>
                                            <mat-select formControlName="name">
                                                <mat-option>
                                                    <ngx-mat-select-search [formControl]="superSpecializationFilterCtrl"
                                                        placeholderLabel="Search Super Specialization"></ngx-mat-select-search>
                                                </mat-option>
                                                <mat-option
                                                    *ngFor="let graduation of filteredSuperSpecializaion | async"
                                                    [value]="graduation">
                                                    {{ graduation }}
                                                </mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                    </div>
                                    <div class="col">
                                        <select class="form-select" id="year" formControlName="year"
                                            style="height:56px">
                                            <option value="" disabled selected>Select Year</option>
                                            <option *ngFor="let year of yearsList" [value]="year">{{ year }}</option>
                                        </select>
                                    </div>
                                    <div class="col">
                                        <mat-form-field appearance="outline" class="w-100">
                                            <mat-label>Institute Name</mat-label>
                                            <mat-select formControlName="institute">
                                                <mat-option>
                                                    <ngx-mat-select-search [formControl]="collegeFilterCtrl"
                                                        placeholderLabel="Search Institute"></ngx-mat-select-search>
                                                </mat-option>
                                                <mat-option *ngFor="let college of filteredColleges | async"
                                                    [value]="college">
                                                    {{ college }}
                                                </mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                    </div>
                                    <div class="col">
                                        <div class="input-group">
                                            <input class="form-control" accept=".pdf,.jpg, .png,.jpeg" type="file"
                                                id="formFile" (change)="upload($event, 'superSpecialization')"
                                                style="height:56px">
                                            <button *ngIf="user.superSpecialization?.document"
                                                (click)="view(user.superSpecialization?.document)"
                                                class="btn btn-primary" type="button">
                                                View
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <hr>
                                <div class="row mb-2" formGroupName="additionalQualification">
                                    <span class="text-success font-italic mb-2">Additional Qualifications</span>
                                    <div class="col">
                                        <mat-form-field appearance="outline" class="w-100">
                                            <mat-label>Qualification</mat-label>
                                            <input matInput placeholder="Qualification" autocomplete="off"
                                                formControlName="name">
                                        </mat-form-field>
                                    </div>
                                    <div class="col">
                                        <select class="form-select" id="year" formControlName="year"
                                            style="height:56px">
                                            <option value="" disabled selected>Select Year</option>
                                            <option *ngFor="let year of yearsList" [value]="year">{{ year }}</option>
                                        </select>
                                    </div>
                                    <div class="col">
                                        <mat-form-field appearance="outline" class="w-100">
                                            <mat-label>Name Of Institute</mat-label>
                                            <input matInput placeholder="Institute" autocomplete="off"
                                                formControlName="institute">
                                        </mat-form-field>
                                    </div>
                                    <div class="col">
                                        <div class="row">
                                            <div class="col">
                                                <input class="form-control" accept=".pdf,.jpg, .png,.jpeg" type="file"
                                                    id="formFile" (change)="upload($event, 'additionalQualification')"
                                                    style="height:56px">
                                            </div>
                                            <div *ngIf="user.additionalQualification?.document" class="col-sm-3">
                                                <div (click)="view(user.additionalQualification?.document)"
                                                    class="btn btn-primary"> View</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-1 d-flex align-items-center">
                                        <button type="button" class="btn btn-outline-success"
                                            (click)="addAdditionalRow()"><i class="bi bi-plus-lg"></i></button>
                                    </div>
                                </div>
                                <div class="row mb-2" *ngFor="let row of additionalRows; let i = index">
                                    <div class="col">
                                        <mat-form-field appearance="outline" class="w-100">
                                            <mat-label>Qualification</mat-label>
                                            <input matInput placeholder="Qualification">
                                        </mat-form-field>
                                    </div>
                                    <div class="col">
                                        <select class="form-select" style="height:56px">
                                            <option value="" disabled selected>Select Year</option>
                                            <option *ngFor="let year of yearsList" [value]="year">{{ year }}</option>
                                        </select>
                                    </div>
                                    <div class="col">
                                        <mat-form-field appearance="outline" class="w-100">
                                            <mat-label>Name Of Institute</mat-label>
                                            <input matInput placeholder="Institute">
                                        </mat-form-field>
                                    </div>
                                    <div class="col">
                                        <input class="form-control" accept=".pdf,.jpg, .png,.jpeg" type="file"
                                            style="height:56px">
                                    </div>
                                    <div class="col-sm-1 d-flex align-items-center">
                                        <button type="button" class="btn btn-outline-danger"
                                            (click)="removeAdditionalRow(i)">
                                            <i class="bi bi-x-lg"></i>
                                        </button>
                                    </div>
                                </div>
                                <hr>
                            </div>
                        </div>
                    </div>
                </div>
                <div *ngIf="tab =='hosp_info'">
                    <div class="card mb-4">
                        <div class="card-body">
                            <p class="mb-4" *ngIf="user.role=='physician'"><span
                                    class="text-primary font-italic me-1">Hospital / Clinic Information</span>
                            </p>
                            <p class="mb-4" *ngIf="user.role!='physician' && user.role!='patient'"><span
                                    class="text-primary font-italic me-1">Basic Information</span>
                            </p>
                            <div class="row">
                                <div *ngIf="user.role=='physician'" class="col-sm-6">
                                    <mat-form-field appearance="outline" class="w-100">
                                        <mat-label>Hospital / Clinic Name</mat-label>
                                        <input matInput formControlName="clinicName" placeholder="Hospital Clinic Name"
                                            autocomplete="off">
                                        <mat-error *ngIf="submitted && f['clinicName']?.errors?.['required']">
                                            Hospital / Clinic Name is required
                                        </mat-error>
                                        <mat-error *ngIf="submitted && f['clinicName']?.errors?.['pattern']">
                                            Enter valid Hospital / Clinic Name
                                        </mat-error>
                                    </mat-form-field>
                                </div>
                                <div *ngIf="user.role!='physician'" class="col-sm-6">
                                    <mat-form-field appearance="outline" class="w-100">
                                        <mat-label>Organization Name</mat-label>
                                        <input matInput formControlName="orgName" placeholder="Organization Name"
                                            autocomplete="off">
                                        <mat-error *ngIf="submitted && f['orgName'].errors">
                                            Organization Name is required
                                        </mat-error>
                                    </mat-form-field>
                                </div>
                                <div *ngIf="user.role!='physician'" class="col-sm-6">
                                    <mat-form-field appearance="outline" class="w-100">
                                        <mat-label>Organization Type</mat-label>
                                        <input matInput value="{{user.role | titlecase}}" [readOnly]="true">
                                    </mat-form-field>
                                </div>
                            </div>
                            <hr>
                            <div class="row">
                                <div class="col-sm-6">
                                    <mat-form-field appearance="outline" class="w-100">
                                        <mat-label>House/ Flat Number</mat-label>
                                        <input matInput placeholder="House/ Flat Number" autocomplete="off"
                                            formControlName="clinicAddress1">
                                    </mat-form-field>
                                </div>
                                <div class="col-sm-6">
                                    <mat-form-field appearance="outline" class="w-100">
                                        <mat-label>Building / Society</mat-label>
                                        <input matInput placeholder="Building / Society" autocomplete="off"
                                            formControlName="clinicAddress2">
                                    </mat-form-field>
                                </div>
                            </div>
                            <hr>
                            <div class="row">
                                <div class="col-12">
                                    <mat-form-field appearance="outline" class="w-100">
                                        <mat-label>Area / Locality</mat-label>
                                        <textarea matInput placeholder="Area" autocomplete="off"
                                            formControlName="clinicArea"></textarea>
                                        <mat-error *ngIf="submitted && f['clinicArea'].errors">
                                            Area / Locality is required
                                        </mat-error>
                                    </mat-form-field>
                                </div>
                            </div>
                            <hr>
                            <div class="row">
                                <div class="col">
                                    <mat-form-field appearance="outline" class="w-100">
                                        <mat-label>Pin Code</mat-label>
                                        <input matInput placeholder="Pin Code" autocomplete="off"
                                            formControlName="clinicPincode">
                                        <mat-error *ngIf="submitted && f['clinicPincode'].errors">
                                            <div *ngIf="f['clinicPincode'].errors['required']">Pincode is required</div>
                                            <div *ngIf="f['clinicPincode'].errors['pattern']">Please enter a valid
                                                6-digit Indian pincode.</div>
                                        </mat-error>
                                    </mat-form-field>
                                </div>
                                <div class="col">
                                    <mat-form-field appearance="outline" class="w-100">
                                        <mat-label>Select State</mat-label>
                                        <mat-select formControlName="clinicState"
                                            (selectionChange)="onClinicStateChange($event)">
                                            <mat-option>
                                                <ngx-mat-select-search [formControl]="clinicStateFilterCtrl"
                                                    placeholderLabel="Search state"></ngx-mat-select-search>
                                            </mat-option>
                                            <mat-option *ngFor="let clinicState of filteredClinicStates | async"
                                                [value]="clinicState.isoCode">
                                                {{ clinicState.name }}
                                            </mat-option>
                                        </mat-select>
                                        <mat-error *ngIf="submitted && f['clinicState'].errors">
                                            State is required
                                        </mat-error>
                                    </mat-form-field>
                                </div>
                                <div class="col">
                                    <mat-form-field appearance="outline" class="w-100">
                                        <mat-label>Select City</mat-label>
                                        <mat-select formControlName="clinicCity">
                                            <mat-option>
                                                <ngx-mat-select-search [formControl]="clinicCityFilterCtrl"
                                                    placeholderLabel="Search clinicCity"></ngx-mat-select-search>
                                            </mat-option>
                                            <mat-option *ngFor="let clinicCity of filteredClinicCities | async"
                                                [value]="clinicCity.name">
                                                {{ clinicCity.name }}
                                            </mat-option>
                                        </mat-select>
                                        <mat-error *ngIf="submitted && f['clinicCity'].errors">City is
                                            required</mat-error>
                                    </mat-form-field>
                                </div>
                            </div>
                            <hr>
                        </div>
                    </div>
                </div>
                <div *ngIf="tab ==='auth_per'">
                    <div class="card mb-4">
                        <div class="card-body">
                            <p class="mb-4"><span class="text-primary font-italic me-1">Personal Information</span>
                            </p>
                            <div class="row">
                                <div class="col-sm-4">
                                    <mat-form-field appearance="outline" class="w-100">
                                        <mat-label>First Name</mat-label>
                                        <input matInput placeholder="First Name" autocomplete="off"
                                            formControlName="authFirstName">
                                        <mat-error *ngIf="submitted && f['authFirstName'].errors">
                                            <div *ngIf="f['authFirstName'].errors['required']">First Name is required
                                            </div>
                                            <div *ngIf="f['authFirstName'].errors['pattern']">Please enter a valid first
                                                name.</div>
                                        </mat-error>
                                    </mat-form-field>
                                </div>
                                <div class="col-sm-4">
                                    <mat-form-field appearance="outline" class="w-100">
                                        <mat-label>Middle Name</mat-label>
                                        <input matInput placeholder="Middle Name" autocomplete="off"
                                            formControlName="authMiddleName">
                                    </mat-form-field>
                                </div>
                                <div class="col-sm-4">
                                    <mat-form-field appearance="outline" class="w-100">
                                        <mat-label>Last Name</mat-label>
                                        <input matInput placeholder="Last Name" autocomplete="off"
                                            formControlName="authLastName">
                                        <mat-error *ngIf="submitted && f['authLastName'].errors">
                                            <div *ngIf="f['authLastName'].errors['required']">Last Name is required
                                            </div>
                                            <div *ngIf="f['authLastName'].errors['pattern']">Please enter a valid last
                                                name.</div>
                                        </mat-error>
                                    </mat-form-field>
                                </div>
                            </div>
                            <hr>
                            <div class="row">
                                <div class="col-sm-6">
                                    <mat-form-field appearance="outline" class="w-100">
                                        <mat-label>Designation</mat-label>
                                        <input matInput placeholder="Designation" autocomplete="off"
                                            formControlName="authDesignation">
                                        <mat-error *ngIf="submitted && f['authDesignation'].errors">
                                            <div>Designation is required</div>
                                        </mat-error>
                                    </mat-form-field>
                                </div>
                                <div class="col-sm-6">
                                    <mat-form-field appearance="outline" class="w-100">
                                        <mat-label>Department</mat-label>
                                        <input matInput placeholder="Department" autocomplete="off"
                                            formControlName="authDept">
                                    </mat-form-field>
                                </div>
                            </div>
                            <hr>
                            <div class="row">
                                <div class="col-sm-3">
                                    <mat-form-field appearance="outline" class="w-100">
                                        <mat-label>Landline</mat-label>
                                        <input matInput placeholder="Landline" autocomplete="off"
                                            formControlName="landLine">
                                    </mat-form-field>
                                </div>
                                <div class="col-sm-3">
                                    <mat-form-field appearance="outline" class="w-100">
                                        <mat-label>Mobile</mat-label>
                                        <input matInput placeholder="Mobile" autocomplete="off"
                                            formControlName="authMob">
                                        <mat-error *ngIf="submitted && f['authMob'].errors">
                                            <div>Mobile is required</div>
                                        </mat-error>
                                    </mat-form-field>
                                </div>
                                <div class="col-sm-3">
                                    <mat-form-field appearance="outline" class="w-100">
                                        <mat-label>Email</mat-label>
                                        <input matInput placeholder="Email" autocomplete="off"
                                            formControlName="authEmail" [readOnly]="true">
                                        <mat-error *ngIf="submitted && f['authEmail'].errors">
                                            <div *ngIf="f['authEmail'].invalid">Email is invalid</div>
                                        </mat-error>
                                    </mat-form-field>
                                </div>
                            </div>
                            <hr>
                        </div>
                    </div>
                </div>
                <div class="row ">
                    <div class="card bg-light">
                        <div class="row card-body">
                            <div class="text-center">
                                <button type="button" class="btn btn-outline-primary col-sm-2 m-1 text-center"
                                    (click)="save()">Save</button>
                                <button *ngIf="userData.status !=='Submitted' && userData.status !== 'Approved'"
                                    type="submit"
                                    class="btn btn-outline-success col-sm-2 m-1 text-center">Submit</button>
                                <button *ngIf="userData.status ==='Confirm'" type=" submit"
                                    class="btn btn-outline-success col-sm-2 m-1 text-center">Confirm</button>
                                <button type="button" class="btn btn-outline-primary col-sm-2 m-1 text-center"
                                    (click)="reload()">Reload</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </form>
</div>

<ng-template #content let-modal>
    <div class="modal-header">
        <h4 class="modal-title" id="modal-basic-title">Admin Comments</h4>
        <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')"></button>
    </div>
    <div class="modal-body">
        <div class="mb-3">
            {{user.rejectionComments}}
        </div>
    </div>
</ng-template>