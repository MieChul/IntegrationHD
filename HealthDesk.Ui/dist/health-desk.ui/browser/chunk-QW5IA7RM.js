import{a as Z}from"./chunk-HKKSMD6O.js";import{a as q}from"./chunk-6MGL4DD7.js";import{$b as O,Ac as D,Bc as G,C as B,D as te,F as K,Fb as U,Gb as Pe,H as b,Hb as _,I as ie,Ib as we,Ja as a,Ka as z,La as S,Lb as ne,Lc as pe,Ma as Ie,Mb as Fe,Nc as Te,O as y,P as w,Qb as P,Rb as ae,Sb as F,Tb as x,Ub as se,Xb as T,Z as l,Zb as h,_ as p,_b as V,ca as g,cc as le,ec as R,ga as H,ha as c,hb as re,ib as I,ic as M,k as W,kc as me,lc as N,qa as i,r as ee,ra as o,rb as oe,rc as Y,sa as u,sc as ce,tc as A,va as C,w as ke,xa as m,xc as j,ya as v,yc as L,zc as J}from"./chunk-4G2VACRK.js";import"./chunk-H5ORMA4Q.js";function qe(r,f){r&1&&(i(0,"mat-error"),a(1,"Username is required"),o())}function ze(r,f){r&1&&(i(0,"mat-error"),a(1,"Password is required"),o())}var Se=(()=>{class r{constructor(t,n,e,s,d){this.fb=t,this.loaderService=n,this.router=e,this.authService=s,this.notificationService=d,this.hide=!0,this.errorMessage=""}ngOnInit(){this.loginForm=this.fb.group({username:["",h.required],password:["",h.required]})}getControl(t){return this.loginForm.get(t)}onSubmit(){if(this.loginForm.valid){this.loaderService.show();let{username:t,password:n}=this.loginForm.value;this.authService.login(t,n).subscribe({next:e=>{this.loaderService.hide(),e.role==="admin"?this.router.navigate(["/admin"]):e.role!=="physician"&&e.role!=="patient"?e.status!=="Approved"?this.router.navigate(["/account"]):this.router.navigate([`organization/${e.role}`]):this.router.navigate([`/${e.role}`])},error:e=>{this.loaderService.hide(),this.notificationService.showError("Incorrect username or password. Please try again.")}})}}navigateToSignup(){this.router.navigate(["/role-selection"])}navigateVerifyPassword(){this.router.navigate(["/verify-forgot-password"])}onEnterKey(){this.onSubmit()}static{this.\u0275fac=function(n){return new(n||r)(p(A),p(q),p(_),p(Fe),p(F))}}static{this.\u0275cmp=b({type:r,selectors:[["app-login"]],decls:41,vars:6,consts:[[1,"capsule-container"],[1,"logo-container"],[1,"logo-animated"],[3,"ngSubmit","formGroup"],[1,"form-row"],["appearance","outline",1,"full-width"],["matInput","","formControlName","username","required","","type","text","placeholder","Enter username",3,"keydown.enter"],[4,"ngIf"],["matInput","","formControlName","password","required","","placeholder","Enter password",3,"keydown.enter","type"],["mat-icon-button","","matSuffix","",1,"m-1","cursor-pointer",3,"click"],["mat-raised-button","","type","submit",1,"custom-primary","full-width","login-button"],[1,"divider"],[1,"auth-options"],[1,"signup-text"],[1,"cursor-pointer",3,"click"]],template:function(n,e){if(n&1&&(i(0,"div",0)(1,"div",1),u(2,"div",2),i(3,"h2"),a(4,"HealthDesk"),o()(),i(5,"form",3),m("ngSubmit",function(){return e.onSubmit()}),i(6,"div",4)(7,"mat-form-field",5)(8,"mat-label"),a(9,"Username"),o(),i(10,"input",6),m("keydown.enter",function(){return e.onEnterKey()}),o(),g(11,qe,2,0,"mat-error",7),o()(),i(12,"div",4)(13,"mat-form-field",5)(14,"mat-label"),a(15,"Password"),o(),i(16,"input",8),m("keydown.enter",function(){return e.onEnterKey()}),o(),i(17,"div",9),m("click",function(){return e.hide=!e.hide}),i(18,"mat-icon"),a(19),o()(),g(20,ze,2,0,"mat-error",7),o()(),i(21,"button",10),a(22,"Login"),o(),i(23,"div",11),a(24,"or"),o(),i(25,"div",12)(26,"p",13),a(27," Don't have an account ? "),i(28,"a",14),m("click",function(){return e.navigateToSignup()}),i(29,"mat-icon"),a(30,"person_add"),o(),i(31,"b")(32,"u"),a(33,"Register"),o()()()(),i(34,"p",13)(35,"a",14),m("click",function(){return e.navigateVerifyPassword()}),i(36,"mat-icon"),a(37,"lock_open"),o(),i(38,"b")(39,"u"),a(40,"Forgot Password?"),o()()()()()()()),n&2){let s,d;l(5),c("formGroup",e.loginForm),l(6),c("ngIf",((s=e.getControl("username"))==null?null:s.invalid)&&((s=e.getControl("username"))==null?null:s.touched)),l(5),c("type",e.hide?"password":"text"),l(),H("aria-label","Show password"),l(2),z(e.hide?"visibility_off":"visibility"),l(),c("ngIf",((d=e.getControl("password"))==null?null:d.invalid)&&((d=e.getControl("password"))==null?null:d.touched))}},dependencies:[I,R,T,V,O,Y,M,N,x,P,D,j,L,J,G]})}}return r})();var Ve=(()=>{class r{constructor(t){this.router=t}selectRole(t){this.router.navigate(["/verify-otp"],{queryParams:{role:t}})}navigateToLogin(){this.router.navigate(["/login"])}navigateVerifyPassword(){this.router.navigate(["/verify-forgot-password"])}static{this.\u0275fac=function(n){return new(n||r)(p(_))}}static{this.\u0275cmp=b({type:r,selectors:[["app-role-select"]],decls:52,vars:0,consts:[[1,"capsule-container"],[1,"logo-container"],[1,"logo-animated"],[1,"page-header"],[1,"roles-container"],[1,"row"],[1,"role-tile","col","physician-img","m-1",3,"click"],["src","assets/physician.png","alt","Physician"],[1,"role-title"],[1,"role-tile","col","m-1",3,"click"],["src","assets/patient.png","alt","Patient"],["src","assets/hospital.png","alt","Hospital"],["src","assets/lab.png","alt","Laboratory"],["src","assets/neutra.png","alt","Pharmacy"],["src","assets/pharma.png","alt","Pharmaceutical"],[1,"divider"],[1,"auth-options"],[1,"signup-text"],[1,"signup-link","cursor-pointer",3,"click"],[1,"cursor-pointer",3,"click"]],template:function(n,e){n&1&&(i(0,"div",0)(1,"div",1),u(2,"div",2),i(3,"h2"),a(4,"HealthDesk"),o()(),i(5,"h3",3),a(6,"Select Your Role"),o(),i(7,"div",4)(8,"div",5)(9,"div",6),m("click",function(){return e.selectRole("Physician")}),u(10,"img",7),i(11,"div",8),a(12,"Physician"),o()(),i(13,"div",9),m("click",function(){return e.selectRole("Patient")}),u(14,"img",10),i(15,"div",8),a(16,"Patient"),o()(),i(17,"div",9),m("click",function(){return e.selectRole("Hospital")}),u(18,"img",11),i(19,"div",8),a(20,"Hospital"),o()()(),i(21,"div",5)(22,"div",9),m("click",function(){return e.selectRole("Laboratory")}),u(23,"img",12),i(24,"div",8),a(25,"Laboratory"),o()(),i(26,"div",9),m("click",function(){return e.selectRole("Pharmacy")}),u(27,"img",13),i(28,"div",8),a(29,"Pharmacy"),o()(),i(30,"div",9),m("click",function(){return e.selectRole("Pharmaceutical")}),u(31,"img",14),i(32,"div",8),a(33,"Pharmaceutical Co."),o()()()(),i(34,"div",15),a(35,"or"),o(),i(36,"div",16)(37,"p",17),a(38," Already have an account? "),i(39,"a",18),m("click",function(){return e.navigateToLogin()}),i(40,"mat-icon"),a(41,"person_add"),o(),i(42,"b")(43,"u"),a(44,"Login"),o()()()(),i(45,"p",17)(46,"a",19),m("click",function(){return e.navigateVerifyPassword()}),i(47,"mat-icon"),a(48,"lock_open"),o(),i(49,"b")(50,"u"),a(51,"Forgot Password ?"),o()()()()()())},dependencies:[x]})}}return r})();var be=(()=>{class r{constructor(t){this.http=t,this.apiUrl=ne.apiUrl+"/otp"}sendOtp(t,n){return this.http.post(`${this.apiUrl}/send`,{contact:t,isEmail:n})}verifyOtp(t,n,e){return this.http.post(`${this.apiUrl}/verify`,{contact:t,otp:n,otpToken:e})}static{this.\u0275fac=function(n){return new(n||r)(K(oe))}}static{this.\u0275prov=B({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();function $e(r,f){if(r&1&&(i(0,"mat-error"),a(1),o()),r&2){let t=v();l(),S(" ",t.selectedRole==="Physician"||t.selectedRole==="Patient"?"Please enter a valid mobile number":"Please enter a valid email"," ")}}function Be(r,f){if(r&1){let t=C();i(0,"div",17)(1,"re-captcha",18),m("resolved",function(e){y(t);let s=v();return w(s.onCaptchaResolved(e))}),o()()}}function He(r,f){if(r&1&&(i(0,"div",19)(1,"span",20),a(2),o()()),r&2){let t=v();l(2),S("Resend OTP in ",t.countdown," seconds")}}function Ye(r,f){if(r&1){let t=C();i(0,"input",26),m("keyup",function(e){let s=y(t).index,d=v(2);return w(d.moveToNext(e,s))})("keydown.enter",function(){y(t);let e=v(2);return w(e.onEnterKey())}),o()}if(r&2){let t=f.index;c("formControlName",t)}}function Je(r,f){if(r&1){let t=C();i(0,"div",21)(1,"h4",22),a(2,"Enter OTP"),o(),i(3,"div",23),g(4,Ye,1,1,"input",24),o(),i(5,"button",25),m("click",function(){y(t);let e=v();return w(e.verifyOtp())}),a(6,"Verify OTP"),o()()}if(r&2){let t=v();c("formGroup",t.verifyOtpForm),l(4),c("ngForOf",t.otpControls.controls),l(),c("disabled",!t.areAllOtpFilled())}}var Me=(()=>{class r{constructor(t,n,e,s,d,k,ye){this.fb=t,this.router=n,this.otpService=e,this.authStateService=s,this.notificationService=d,this.route=k,this.loader=ye,this.isOtpSent=!1,this.isResendAvailable=!1,this.countdown=60,this.selectedRole="",this.captchaVerified=!1,this.otpToken="",this.isEmail=!1}ngOnInit(){this.route.queryParams.subscribe(t=>{this.selectedRole=t.role||null}),this.verifyOtpForm=this.fb.group({contact:["",this.getContactValidator()],otp:this.fb.array(new Array(6).fill("").map(()=>new le("",h.required)))})}get otpControls(){return this.verifyOtpForm.get("otp")}getContactValidator(){return this.selectedRole==="Physician"||this.selectedRole==="Patient"?[h.required,h.pattern(/^(\+91[-\s]?)?[0]?(91)?[789]\d{9}$/)]:[h.required,h.email]}onCaptchaResolved(t){this.captchaVerified=!!t}getControl(t){return this.verifyOtpForm.get(t)}sendOtp(){this.loader.show(),this.isEmail=!(this.selectedRole==="Physician"||this.selectedRole==="Patient"),this.verifyOtpForm.get("contact")?.value&&this.captchaVerified&&this.otpService.sendOtp(this.verifyOtpForm.get("contact")?.value,this.isEmail).subscribe({next:t=>{this.notificationService.showSuccess("OTP Sent successfully"),this.otpToken=t.otpToken,this.isOtpSent=!0,this.startCountdown(),this.loader.hide()},error:t=>{this.loader.hide(),this.loader.hide(),t.error?this.notificationService.showError(t.error):this.notificationService.showError("OTP sending failed. Try again after sometime.")}})}startCountdown(){this.isResendAvailable=!1,this.countdown=60,this.countdownSubscription=W(1e3).pipe(ee(this.countdown)).subscribe({next:t=>{this.countdown=60-t-1},complete:()=>{this.isResendAvailable=!0}})}resendOtp(){this.isResendAvailable&&this.sendOtp()}verifyOtp(){this.loader.show();let t=this.verifyOtpForm.get("contact")?.value,n=this.otpControls.value.join("");this.otpService.verifyOtp(t,n,this.otpToken).subscribe({next:e=>{this.loader.hide(),e.valid?(this.authStateService.setOtpVerified(!0),this.router.navigate(["/register"],{queryParams:{role:this.selectedRole,contact:this.verifyOtpForm.get("contact")?.value,isEmail:this.isEmail}})):this.notificationService.showError("Invalid OTP")},error:e=>{this.loader.hide(),e.error?this.notificationService.showError(e.error):this.notificationService.showError("OTP verification failed. Try again after sometime.")}})}ngOnDestroy(){this.countdownSubscription&&this.countdownSubscription.unsubscribe()}navigateToLogin(){this.router.navigate(["/login"])}navigateVerifyPassword(){this.router.navigate(["/verify-forgot-password"])}moveToNext(t,n){let e=t.target;if(t.key>="0"&&t.key<="9"){let s=e.nextElementSibling;s&&s.focus()}if(t.key==="Backspace"){let s=e.previousElementSibling;s&&s.focus()}}areAllOtpFilled(){return this.otpControls.controls.every(t=>t.value.trim()!=="")}onEnterKey(){this.areAllOtpFilled()&&this.verifyOtp()}static{this.\u0275fac=function(n){return new(n||r)(p(A),p(_),p(be),p(Z),p(F),p(U),p(q))}}static{this.\u0275cmp=b({type:r,selectors:[["app-verify-otp"]],decls:36,vars:11,consts:[[1,"capsule-container"],[1,"logo-container"],[1,"logo-animated"],[1,"page-header"],[3,"ngSubmit","formGroup"],["appearance","outline",1,"full-width"],["matInput","","formControlName","contact",3,"placeholder"],[4,"ngIf"],["class","captcha-container",4,"ngIf"],["class","resend-otp-message",4,"ngIf"],["mat-raised-button","","color","primary","type","submit",1,"full-width","login-button","m-3",3,"disabled"],["class","otp-section",3,"formGroup",4,"ngIf"],[1,"divider"],[1,"auth-options"],[1,"signup-text"],[1,"signup-link","cursor-pointer",3,"click"],[1,"cursor-pointer",3,"click"],[1,"captcha-container"],["siteKey","6LeLvHIqAAAAAJJVlNmel7PIIAdvQ1Gw3JeaXSMP",3,"resolved"],[1,"resend-otp-message"],[1,"resend-countdown"],[1,"otp-section",3,"formGroup"],[1,"otp-title"],["formArrayName","otp",1,"otp-inputs"],["maxlength","1","class","otp-input",3,"formControlName","keyup","keydown.enter",4,"ngFor","ngForOf"],["mat-raised-button","","color","primary",1,"full-width","login-button","m-2",3,"click","disabled"],["maxlength","1",1,"otp-input",3,"keyup","keydown.enter","formControlName"]],template:function(n,e){if(n&1&&(i(0,"div",0)(1,"div",1),u(2,"div",2),i(3,"h2",3),a(4,"HealthDesk"),o()(),i(5,"h4",3),a(6),o(),i(7,"form",4),m("ngSubmit",function(){return e.sendOtp()}),i(8,"mat-form-field",5)(9,"mat-label"),a(10),o(),u(11,"input",6),g(12,$e,2,1,"mat-error",7),o(),g(13,Be,2,0,"div",8)(14,He,3,1,"div",9),i(15,"button",10),a(16),o()(),g(17,Je,7,3,"div",11),i(18,"div",12),a(19,"or"),o(),i(20,"div",13)(21,"p",14),a(22," Already have an account ? "),i(23,"a",15),m("click",function(){return e.navigateToLogin()}),i(24,"mat-icon"),a(25,"person_add"),o(),i(26,"b")(27,"u"),a(28,"Login"),o()()()(),i(29,"p",14)(30,"a",16),m("click",function(){return e.navigateVerifyPassword()}),i(31,"mat-icon"),a(32,"lock_open"),o(),i(33,"b")(34,"u"),a(35,"Forgot Password ?"),o()()()()()()),n&2){let s;l(6),Ie("Verify Your ",e.selectedRole==="Physician"||e.selectedRole==="Patient"?"Mobile Number":"Email"," for ",e.selectedRole,""),l(),c("formGroup",e.verifyOtpForm),l(3),z(e.selectedRole==="Physician"||e.selectedRole==="Patient"?"Mobile Number":"Email"),l(),c("placeholder",e.selectedRole==="Physician"||e.selectedRole==="Patient"?"Enter Mobile Number":"Enter Email"),l(),c("ngIf",((s=e.getControl("contact"))==null?null:s.invalid)&&((s=e.verifyOtpForm.get("contact"))==null?null:s.touched)),l(),c("ngIf",!e.isOtpSent),l(),c("ngIf",e.isOtpSent&&!e.isResendAvailable),l(),c("disabled",!e.captchaVerified||e.isOtpSent&&!e.isResendAvailable),l(),S(" ",e.isOtpSent?"Resend OTP":"Send OTP"," "),l(),c("ngIf",e.isOtpSent)}},dependencies:[re,I,R,T,V,O,ce,M,N,me,pe,x,P,D,j,L,G]})}}return r})();var xe=function(r){return r[r.Patient=2]="Patient",r[r.Physician=1]="Physician",r[r.Admin=3]="Admin",r[r.Hospital=4]="Hospital",r[r.Laboratory=5]="Laboratory",r[r.Pharmaceutical=6]="Pharmaceutical",r[r.Nutraceutical=7]="Nutraceutical",r}(xe||{});function Ne(r){let f=r.charAt(0).toUpperCase()+r.slice(1).toLowerCase();if(xe[f]!==void 0)return xe[f]}var Q=(()=>{class r{constructor(t){this.http=t,this.apiUrl=ne.apiUrl+"/user"}register(t){return this.http.post(`${this.apiUrl}/register`,t)}resetPassword(t,n,e){return this.http.post(`${this.apiUrl}/reset-password`,{contact:t,newPassword:n,isEmail:e})}getUsername(t){return this.http.get(`${this.apiUrl}/get-username/${t}`,{withCredentials:!0})}static{this.\u0275fac=function(n){return new(n||r)(K(oe))}}static{this.\u0275prov=B({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();function Qe(r,f){if(r&1){let t=C();i(0,"mat-form-field",6)(1,"mat-label"),a(2,"Mobile Number"),o(),i(3,"input",23),m("keydown.enter",function(){y(t);let e=v();return w(e.onEnterKey())}),o()()}}function Xe(r,f){if(r&1){let t=C();i(0,"mat-form-field",6)(1,"mat-label"),a(2,"Email"),o(),i(3,"input",24),m("keydown.enter",function(){y(t);let e=v();return w(e.onEnterKey())}),o()()}}function We(r,f){r&1&&(i(0,"mat-error"),a(1),o()),r&2&&(l(),S(" ","Please enter a valid username"," "))}function et(r,f){r&1&&(i(0,"mat-error"),a(1),o()),r&2&&(l(),S(" ","Please enter a valid password"," "))}function tt(r,f){r&1&&(i(0,"mat-error"),a(1," Passwords do not match "),o())}var Ae=(()=>{class r{constructor(t,n,e,s,d,k){this.fb=t,this.router=n,this.userService=e,this.loaderService=s,this.notificationService=d,this.route=k,this.selectedRole="",this.prefilledMobile="",this.prefilledEmail="",this.hide=!0}ngOnInit(){this.route.queryParams.subscribe(t=>{this.selectedRole=t.role||null,t.isEmail==="true"?this.prefilledEmail=t.contact:this.prefilledMobile=t.contact}),this.registerForm=this.fb.group({role:[{value:this.selectedRole,disabled:!0}],mobile:[{value:this.prefilledMobile,disabled:!0}],email:[{value:this.prefilledEmail,disabled:!0}],username:["",[h.required,h.pattern(/^[a-zA-Z0-9.@]{5,15}$/)]],password:["",[h.required,h.pattern(/^[a-zA-Z0-9_@.$&*-]{6,}$/)]],confirmPassword:["",h.required]})}isPasswordMatch(){return this.registerForm.get("password")?.value===this.registerForm.get("confirmPassword")?.value}getControl(t){return this.registerForm.get(t)}onSubmit(){if(this.registerForm.valid&&this.isPasswordMatch()){this.loaderService.show();var t=Ne(this.selectedRole);let n={username:this.registerForm.get("username")?.value,password:this.registerForm.get("password")?.value,email:this.prefilledEmail,mobile:this.prefilledMobile,roleId:t};this.userService.register(n).subscribe({next:()=>{this.loaderService.hide(),this.notificationService.showSuccess("Registration successful. Redirecting to login..."),setTimeout(()=>{this.router.navigate(["/login"])},3e3)},error:e=>{this.loaderService.hide(),e.error?this.notificationService.showError(e.error):this.notificationService.showError("Registration failed. Please try again.")}})}else this.isPasswordMatch()||this.notificationService.showError("Passwords do not match.")}onClear(){this.registerForm.reset({role:{value:this.selectedRole,disabled:!0},mobile:{value:this.prefilledMobile,disabled:!!this.prefilledMobile},email:{value:this.prefilledEmail,disabled:!!this.prefilledEmail}})}navigateToLogin(){this.router.navigate(["/login"])}navigateVerifyPassword(){this.router.navigate(["/verify-forgot-password"])}onEnterKey(){this.onSubmit()}static{this.\u0275fac=function(n){return new(n||r)(p(A),p(_),p(Q),p(q),p(F),p(U))}}static{this.\u0275cmp=b({type:r,selectors:[["app-register"]],decls:60,vars:9,consts:[[1,"capsule-container"],[1,"logo-container"],[1,"logo-animated"],[1,"page-header"],[3,"ngSubmit","formGroup"],[1,"form-row"],["appearance","outline",1,"full-width"],["matInput","","formControlName","role","readonly","",1,"disabled-bold",3,"keydown.enter"],["appearance","outline","class","full-width",4,"ngIf"],["matInput","","formControlName","username","placeholder","Enter username",3,"keydown.enter"],["mat-icon-button","","matSuffix","","matTooltip","A lphanumeric bweteen 5 to 15 characters long and symbols (. @) allowed. "],[4,"ngIf"],["matInput","","formControlName","password","type","password","placeholder","Enter password",3,"keydown.enter"],["mat-icon-button","","matSuffix","","matTooltip","6+ characters, alphanumeric, and symbols (_@.$&*-)"],["matInput","","formControlName","confirmPassword","required","","placeholder","Confirm password",3,"keydown.enter","type"],["mat-icon-button","","matSuffix","",1,"m-1","cursor-pointer",3,"click"],[1,"button-container"],["mat-raised-button","","color","primary","type","submit"],["mat-raised-button","","color","warn","type","button",3,"click"],[1,"auth-options"],[1,"signup-text"],[1,"signup-link","cursor-pointer",3,"click"],[1,"cursor-pointer",3,"click"],["matInput","","formControlName","mobile","placeholder","Enter mobile number",3,"keydown.enter"],["matInput","","formControlName","email","placeholder","Enter email",3,"keydown.enter"]],template:function(n,e){if(n&1&&(i(0,"div",0)(1,"div",1),u(2,"div",2),o(),i(3,"h3",3),a(4,"Register"),o(),i(5,"form",4),m("ngSubmit",function(){return e.onSubmit()}),i(6,"div",5)(7,"mat-form-field",6)(8,"mat-label"),a(9,"Role *"),o(),i(10,"input",7),m("keydown.enter",function(){return e.onEnterKey()}),o()(),g(11,Qe,4,0,"mat-form-field",8)(12,Xe,4,0,"mat-form-field",8),o(),i(13,"div",5)(14,"mat-form-field",6)(15,"mat-label"),a(16,"Username"),o(),i(17,"input",9),m("keydown.enter",function(){return e.onEnterKey()}),o(),i(18,"button",10)(19,"mat-icon"),a(20,"info"),o()(),g(21,We,2,1,"mat-error",11),o()(),i(22,"div",5)(23,"mat-form-field",6)(24,"mat-label"),a(25,"Password"),o(),i(26,"input",12),m("keydown.enter",function(){return e.onEnterKey()}),o(),i(27,"button",13)(28,"mat-icon"),a(29,"info"),o()(),g(30,et,2,1,"mat-error",11),o(),i(31,"mat-form-field",6)(32,"mat-label"),a(33,"Confirm Password"),o(),i(34,"input",14),m("keydown.enter",function(){return e.onEnterKey()}),o(),i(35,"div",15),m("click",function(){return e.hide=!e.hide}),i(36,"mat-icon"),a(37),o()(),g(38,tt,2,0,"mat-error",11),o()(),i(39,"div",16)(40,"button",17),a(41,"Register"),o(),i(42,"button",18),m("click",function(){return e.onClear()}),a(43,"Clear"),o()()(),i(44,"div",19)(45,"p",20),a(46," Already have an account ? "),i(47,"a",21),m("click",function(){return e.navigateToLogin()}),i(48,"mat-icon"),a(49,"person_add"),o(),i(50,"b")(51,"u"),a(52,"Login"),o()()()(),i(53,"p",20)(54,"a",22),m("click",function(){return e.navigateVerifyPassword()}),i(55,"mat-icon"),a(56,"lock_open"),o(),i(57,"b")(58,"u"),a(59,"Forgot Password ?"),o()()()()()()),n&2){let s,d,k;l(5),c("formGroup",e.registerForm),l(6),c("ngIf",e.prefilledMobile),l(),c("ngIf",e.prefilledEmail),l(9),c("ngIf",((s=e.getControl("username"))==null?null:s.invalid)&&((s=e.getControl("username"))==null?null:s.touched)),l(9),c("ngIf",((d=e.getControl("password"))==null?null:d.invalid)&&((d=e.getControl("password"))==null?null:d.touched)),l(4),c("type",e.hide?"password":"text"),l(),H("aria-label","Show password"),l(2),z(e.hide?"visibility_off":"visibility"),l(),c("ngIf",!e.isPasswordMatch()&&((k=e.getControl("confirmPassword"))==null?null:k.touched))}},dependencies:[I,R,T,V,O,Y,M,N,x,P,ae,se,D,j,L,J,G]})}}return r})();function it(r,f){r&1&&(i(0,"mat-error"),a(1),o()),r&2&&(l(),S(" ","Please enter a valid password"," "))}function rt(r,f){r&1&&(i(0,"mat-error"),a(1," Passwords do not match "),o())}var je=(()=>{class r{constructor(t,n,e,s,d,k){this.fb=t,this.route=n,this.userService=e,this.router=s,this.notification=d,this.loader=k,this.contactInfo="",this.isEmail=!1,this.hide=!0}ngOnInit(){this.route.queryParams.subscribe(t=>{this.isEmail=t.isEmail==="true",this.contactInfo=t.contact}),this.forgotPasswordForm=this.fb.group({contactInfo:[{value:this.contactInfo,disabled:!0}],password:["",[h.required,h.pattern(/^[a-zA-Z0-9_@.$&*-]{6,}$/)]],confirmPassword:["",h.required]})}getControl(t){return this.forgotPasswordForm.get(t)}onSubmit(){if(this.loader.show(),this.forgotPasswordForm.valid&&this.isPasswordMatch()){let t=this.forgotPasswordForm.get("password")?.value;this.userService.resetPassword(this.contactInfo,t,this.isEmail).subscribe({next:()=>{this.loader.hide(),this.notification.showSuccess("Password successfully reset! Redirecting to login..."),setTimeout(()=>{this.router.navigate(["/login"])},3e3)},error:n=>{this.loader.hide(),this.notification.showError(n.error.message||"Password reset failed. Please try again.")}})}}isPasswordMatch(){var t=this.forgotPasswordForm.get("password")?.value===this.forgotPasswordForm.get("confirmPassword")?.value;return t||this.loader.hide(),t}static{this.\u0275fac=function(n){return new(n||r)(p(A),p(U),p(Q),p(_),p(F),p(q))}}static{this.\u0275cmp=b({type:r,selectors:[["app-forgot-password"]],decls:28,vars:7,consts:[[1,"capsule-container"],[1,"logo-container"],[1,"logo-animated"],[1,"page-header"],[3,"ngSubmit","formGroup"],["appearance","outline",1,"full-width"],["matInput","","formControlName","contactInfo","readonly",""],["matInput","","formControlName","password","type","password","placeholder","Enter password"],["mat-icon-button","","matSuffix","","matTooltip","6+ characters, alphanumeric, and symbols (_@.$&*-)"],[4,"ngIf"],["matInput","","formControlName","confirmPassword","required","","placeholder","Confirm password",3,"type"],["mat-icon-button","","matSuffix","",1,"m-1","cursor-pointer",3,"click"],["mat-raised-button","","color","primary","type","submit"]],template:function(n,e){if(n&1&&(i(0,"div",0)(1,"div",1),u(2,"div",2),i(3,"h2",3),a(4,"Reset Password"),o()(),i(5,"form",4),m("ngSubmit",function(){return e.onSubmit()}),i(6,"mat-form-field",5)(7,"mat-label"),a(8),o(),u(9,"input",6),o(),i(10,"mat-form-field",5)(11,"mat-label"),a(12,"Password"),o(),u(13,"input",7),i(14,"button",8)(15,"mat-icon"),a(16,"info"),o()(),g(17,it,2,1,"mat-error",9),o(),i(18,"mat-form-field",5)(19,"mat-label"),a(20,"Confirm Password"),o(),u(21,"input",10),i(22,"div",11),m("click",function(){return e.hide=!e.hide}),i(23,"mat-icon"),a(24),o()(),g(25,rt,2,0,"mat-error",9),o(),i(26,"button",12),a(27,"Reset Password"),o()()()),n&2){let s,d;l(5),c("formGroup",e.forgotPasswordForm),l(3),z(e.isEmail?"Email Id":"Mobile Number"),l(9),c("ngIf",((s=e.getControl("password"))==null?null:s.invalid)&&((s=e.getControl("password"))==null?null:s.touched)),l(4),c("type",e.hide?"password":"text"),l(),H("aria-label","Show password"),l(2),z(e.hide?"visibility_off":"visibility"),l(),c("ngIf",!e.isPasswordMatch()&&((d=e.getControl("confirmPassword"))==null?null:d.touched))}},dependencies:[I,R,T,V,O,Y,M,N,x,P,ae,se,D,j,L,J,G]})}}return r})();var Ee=(()=>{class r{constructor(t,n){this.authStateService=t,this.router=n}canActivate(t,n){if(this.authStateService.isOtpVerified())return!0;{let e=n.url.includes("forgot-password")?"/verify-forgot-password":"/verify-otp";return this.router.navigate([e]),!1}}static{this.\u0275fac=function(n){return new(n||r)(K(Z),K(_))}}static{this.\u0275prov=B({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();function ot(r,f){r&1&&(i(0,"mat-error"),a(1," Please enter a valid mobile number "),o())}function nt(r,f){r&1&&(i(0,"mat-error"),a(1," Please enter a valid mobile number "),o())}function at(r,f){if(r&1){let t=C();i(0,"div",19)(1,"re-captcha",20),m("resolved",function(e){y(t);let s=v();return w(s.onCaptchaResolved(e))}),o()()}}function st(r,f){if(r&1&&(i(0,"div",21)(1,"span",22),a(2),o()()),r&2){let t=v();l(2),S("Resend OTP in ",t.countdown," seconds")}}function lt(r,f){if(r&1){let t=C();i(0,"input",28),m("keyup",function(e){let s=y(t).index,d=v(2);return w(d.moveToNext(e,s))})("keydown.enter",function(){y(t);let e=v(2);return w(e.onEnterKey())}),o()}if(r&2){let t=f.index;c("formControlName",t)}}function mt(r,f){if(r&1){let t=C();i(0,"div",23)(1,"h4",24),a(2,"Enter OTP"),o(),i(3,"div",25),g(4,lt,1,1,"input",26),o(),i(5,"button",27),m("click",function(){y(t);let e=v();return w(e.verifyOtp())}),a(6,"Verify OTP"),o()()}if(r&2){let t=v();c("formGroup",t.verifyForm),l(4),c("ngForOf",t.otpControls.controls),l(),c("disabled",!t.areAllOtpFilled())}}var Le=(()=>{class r{constructor(t,n,e,s,d,k,ye){this.fb=t,this.router=n,this.otpService=e,this.authStateService=s,this.loader=d,this.notificationService=k,this.userService=ye,this.isOtpSent=!1,this.isResendAvailable=!1,this.countdown=60,this.captchaVerified=!1,this.otpToken=""}ngOnInit(){this.verifyForm=this.fb.group({email:["",[h.email]],mobile:["",[h.pattern(/^(\+91[-\s]?)?[0]?(91)?[789]\d{9}$/)]],otp:this.fb.array(new Array(6).fill("").map(()=>new le("",h.required)))})}getControl(t){return this.verifyForm.get(t)}get otpControls(){return this.verifyForm.get("otp")}onCaptchaResolved(t){this.captchaVerified=!!t}sendOtp(){this.loader.show();var t=!!this.verifyForm.get("email")?.value;if(this.captchaVerified&&(this.verifyForm.get("mobile")?.value||this.verifyForm.get("email")?.value)){let n="";t?n=this.verifyForm.get("email")?.value:n=this.verifyForm.get("mobile")?.value,this.userService.getUsername(n).pipe(ke(e=>this.otpService.sendOtp(n,t))).subscribe({next:e=>{this.loader.hide(),this.notificationService.showSuccess("OTP sent successfully"),this.otpToken=e.otpToken,this.isOtpSent=!0,this.startCountdown()},error:e=>{this.loader.hide(),e.status===404?this.notificationService.showError("Not registered with app. Please Register"):(console.error("Failed to send OTP",e),this.notificationService.showError("Failed to send OTP. Please try again"))}})}else this.loader.hide(),this.notificationService.showError("Please verify the captcha and provide a valid contact.")}startCountdown(){this.isResendAvailable=!1,this.countdown=60,this.countdownSubscription=W(1e3).pipe(ee(this.countdown)).subscribe({next:t=>{this.countdown=60-t-1},complete:()=>{this.isResendAvailable=!0}})}resendOtp(){this.isResendAvailable&&this.sendOtp()}verifyOtp(){this.loader.show();var t=!!this.verifyForm.get("email")?.value,n="";t?n=this.verifyForm.get("email")?.value:n=this.verifyForm.get("mobile")?.value;let e=this.otpControls.value.join("");this.otpService.verifyOtp(n,e,this.otpToken).subscribe({next:s=>{this.loader.hide(),s.valid?(this.authStateService.setOtpVerified(!0),this.router.navigate(["/forgot-password"],{queryParams:{contact:n,isEmail:t}})):this.notificationService.showError("Invalid OTP. Please try again.")},error:s=>{this.loader.hide(),console.error("OTP verification failed",s),this.notificationService.showError("OTP verification failed. Please try again.")}})}ngOnDestroy(){this.countdownSubscription&&this.countdownSubscription.unsubscribe()}navigateToLogin(){this.router.navigate(["/login"])}navigateToSignup(){this.router.navigate(["/role-selection"])}moveToNext(t,n){let e=t.target;if(t.key>="0"&&t.key<="9"){let s=e.nextElementSibling;s&&s.focus()}if(t.key==="Backspace"){let s=e.previousElementSibling;s&&s.focus()}}areAllOtpFilled(){return this.otpControls.controls.every(t=>t.value.trim()!=="")}onEnterKey(){this.areAllOtpFilled()&&this.verifyOtp()}static{this.\u0275fac=function(n){return new(n||r)(p(A),p(_),p(be),p(Z),p(q),p(F),p(Q))}}static{this.\u0275cmp=b({type:r,selectors:[["app-verify-forgot-password"]],decls:45,vars:8,consts:[[1,"capsule-container"],[1,"logo-container"],[1,"logo-animated"],[1,"page-header"],[3,"ngSubmit","formGroup"],[1,"form-row"],["appearance","outline",1,"full-width"],["matInput","","formControlName","mobile","placeholder","Enter Mobile Number"],[4,"ngIf"],[1,"divider"],["matInput","","formControlName","email","placeholder","Enter Email"],["class","captcha-container",4,"ngIf"],["class","resend-otp-message",4,"ngIf"],["mat-raised-button","","color","primary","type","submit",1,"full-width","login-button","m-3",3,"disabled"],["class","otp-section",3,"formGroup",4,"ngIf"],[1,"auth-options"],[1,"signup-text"],[1,"signup-link","cursor-pointer",3,"click"],[1,"cursor-pointer",3,"click"],[1,"captcha-container"],["siteKey","6LeLvHIqAAAAAJJVlNmel7PIIAdvQ1Gw3JeaXSMP",3,"resolved"],[1,"resend-otp-message"],[1,"resend-countdown"],[1,"otp-section",3,"formGroup"],[1,"otp-title"],["formArrayName","otp",1,"otp-inputs"],["maxlength","1","class","otp-input",3,"formControlName","keyup","keydown.enter",4,"ngFor","ngForOf"],["mat-raised-button","","color","primary",1,"full-width","login-button","m-2",3,"click","disabled"],["maxlength","1",1,"otp-input",3,"keyup","keydown.enter","formControlName"]],template:function(n,e){if(n&1&&(i(0,"div",0)(1,"div",1),u(2,"div",2),i(3,"h2",3),a(4,"HealthDesk"),o()(),i(5,"h3",3),a(6,"Verify Contact"),o(),i(7,"form",4),m("ngSubmit",function(){return e.sendOtp()}),i(8,"div",5)(9,"mat-form-field",6)(10,"mat-label"),a(11," Mobile Number"),o(),u(12,"input",7),g(13,ot,2,0,"mat-error",8),o()(),i(14,"div",9),a(15,"or"),o(),i(16,"div",5)(17,"mat-form-field",6)(18,"mat-label"),a(19," Email"),o(),u(20,"input",10),g(21,nt,2,0,"mat-error",8),o()(),g(22,at,2,0,"div",11)(23,st,3,1,"div",12),i(24,"button",13),a(25),o()(),g(26,mt,7,3,"div",14),i(27,"div",9),a(28,"or"),o(),i(29,"div",15)(30,"p",16),a(31," Don't have an account? "),i(32,"a",17),m("click",function(){return e.navigateToSignup()}),i(33,"mat-icon"),a(34,"person_add"),o(),i(35,"b")(36,"u"),a(37,"Register"),o()()()(),i(38,"p",16)(39,"a",18),m("click",function(){return e.navigateToLogin()}),i(40,"mat-icon"),a(41,"person_add"),o(),i(42,"b")(43,"u"),a(44,"Login ?"),o()()()()()()),n&2){let s,d;l(7),c("formGroup",e.verifyForm),l(6),c("ngIf",((s=e.getControl("mobile"))==null?null:s.invalid)&&((s=e.getControl("mobile"))==null?null:s.touched)),l(8),c("ngIf",((d=e.getControl("email"))==null?null:d.invalid)&&((d=e.getControl("email"))==null?null:d.touched)),l(),c("ngIf",!e.isOtpSent),l(),c("ngIf",e.isOtpSent&&!e.isResendAvailable),l(),c("disabled",!e.captchaVerified||e.isOtpSent&&!e.isResendAvailable),l(),S(" ",e.isOtpSent?"Resend OTP":"Send OTP"," "),l(),c("ngIf",e.isOtpSent)}},dependencies:[re,I,R,T,V,O,ce,M,N,me,pe,x,P,D,j,L,G]})}}return r})();var De=(()=>{class r{constructor(t,n){this.router=t,this.route=n,this.showSidebar=!0}ngOnInit(){}static{this.\u0275fac=function(n){return new(n||r)(p(_),p(U))}}static{this.\u0275cmp=b({type:r,selectors:[["app-anonymous"]],decls:1,vars:0,template:function(n,e){n&1&&u(0,"router-outlet")},dependencies:[Pe],styles:[`body{background:linear-gradient(to right,#e22cdc,#63b4ee,#2cbf5d);animation:gradientAnimation 10s ease infinite;font-family:Roboto,sans-serif;color:#fff;background-size:200% 200%}@keyframes gradientAnimation{0%{background-position:0% 50%}50%{background-position:100% 50%}to{background-position:0% 50%}}.mat-primary{color:#d76745bc}.mat-accent{color:#2cbf5d}.mat-button{color:#2cbf5d;font-weight:700;transition:transform .3s ease,color .3s ease}.mat-button:hover{transform:scale(1.05);color:#d76745bc}.btn-custom{background-color:#d76745bc;border:none;color:#fff;padding:10px 20px;transition:all .3s ease}.btn-custom:hover{background-color:#2cbf5d;transform:scale(1.1);box-shadow:0 4px 15px #0003}.card-custom{background-color:#ffffff1a;border-radius:10px;padding:20px;box-shadow:0 4px 20px #0000001a;transition:transform .4s ease,box-shadow .4s ease}.card-custom:hover{transform:translateY(-10px);box-shadow:0 8px 25px #0000004d}.capsule-container{max-width:360px;max-height:100vh;background-color:#ffffffe6;border-radius:50px;padding:30px;box-shadow:0 10px 20px #0000004d;text-align:center;margin:1% auto auto;display:flex;flex-direction:column;overflow-y:auto;overflow-x:hidden;box-sizing:border-box}.capsule-container::-webkit-scrollbar{width:6px}.capsule-container::-webkit-scrollbar-thumb{background-color:#bb7fbb;border-radius:4px}.capsule-container::-webkit-scrollbar-track{background:transparent}.logo-animated{width:100px;height:100px;margin:0 auto 10px;border-radius:50%;background-image:url("./media/logo-P7TD5553.png");background-size:cover}@keyframes rotate{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.logo-container h2{font-size:2rem;font-weight:700;background:linear-gradient(45deg,#673ab7,#03a9f4,#4caf50);-webkit-background-clip:text;color:transparent;animation:gradient-animation 4s ease-in-out infinite}@keyframes gradient-animation{0%{background-position:0%}to{background-position:100%}}mat-form-field,button,.divider{width:100%;transition:all .3s ease}::ng-deep mat-form-field.mat-form-field-appearance-outline .mat-form-field-outline-thick{border-color:#66bb6a;transition:border-color .3s ease}::ng-deep mat-form-field.mat-form-field-appearance-outline .mat-form-field-outline-thick.mat-focused{border-color:#673ab7;transition:border-color .4s ease}button.login-button{font-size:1rem;padding:10px;transition:transform .3s ease,box-shadow .3s ease}button.login-button:hover{transform:scale(1.05);box-shadow:0 4px 15px #0003}.divider{font-weight:700;color:#333;margin:20px 0;display:flex;align-items:center;position:relative}.divider:before,.divider:after{content:"";flex:1;height:1px;background:#333;margin:0 8px}.auth-options{text-align:center;font-size:.9rem}.auth-options .signup-text{display:flex;justify-content:center;align-items:center;margin:5px 0;color:#7217d4;font-weight:bolder}.auth-options a{display:inline-flex;align-items:center;color:#673ab7;font-weight:600;text-decoration:none;transition:color .3s ease,transform .3s ease;font-size:.9rem}.auth-options a:hover{color:#3f51b5;transform:translateY(-2px)}.auth-options a mat-icon{font-size:1rem;margin-right:5px;vertical-align:middle;transition:transform .3s ease}.roles-container{display:flex;flex-direction:column;gap:20px}.roles-container .role-tile{width:85px;height:85px;background:#fffc;border-radius:15px;box-shadow:0 4px 10px #0003;overflow:hidden;display:flex;align-items:center;justify-content:center;transition:transform .3s ease,box-shadow .3s ease;position:relative;cursor:pointer}.roles-container .role-tile img{width:80%;height:auto;transition:opacity .3s ease}.roles-container .role-tile:hover{transform:scale(1.05);box-shadow:0 4px 15px #0003}.roles-container .role-tile:hover img{opacity:.3}.roles-container .role-tile:hover .role-title{opacity:1;transform:translateY(0)}.roles-container .role-title{position:absolute;bottom:10px;text-align:center;color:#673ab7;font-weight:600;font-size:.65rem;opacity:0;transform:translateY(10px);transition:opacity .3s ease,transform .3s ease}.otp-section{margin-top:20px}.button-container{display:flex;justify-content:space-between;margin-top:20px}.otp-input{width:40px;height:40px;text-align:center;font-size:1.5rem;border-radius:5px;border:2px solid #4caf50;box-shadow:0 4px 8px #4caf504d;transition:transform .3s ease,box-shadow .3s ease;margin-bottom:5px}.otp-input:focus{outline:none;transform:scale(1.1);box-shadow:0 6px 12px #4caf5066;border-color:#388e3c}.success-snackbar{background-color:#4caf50!important;color:#fff}.error-snackbar{background-color:#f44336!important;color:#fff}.captcha-container{margin-bottom:15px}.resend-otp-message{color:#4caf50;font-size:.9rem;margin-bottom:10px}.otp-title{color:#4caf50;font-weight:700;font-size:1.2rem;margin-top:20px}.cursor-pointer{cursor:pointer}.page-header{font-size:2.5rem;font-weight:600;font-family:Roboto,sans-serif;text-align:center;margin-bottom:20px;color:transparent;background:linear-gradient(to right,#e22cdc,#63b4ee,#2cbf5d);-webkit-background-clip:text;background-clip:text;animation:fadeInTop 1s ease-out,gradientTextAnimation 10s ease infinite;background-size:200% 200%}@keyframes gradientTextAnimation{0%{background-position:0% 50%}50%{background-position:100% 50%}to{background-position:0% 50%}}@keyframes fadeInTop{0%{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}.disabled-bold{font-weight:700;color:#333;background-color:#f9f9f9;border:1px solid #ccc;pointer-events:none}
`],encapsulation:2})}}return r})();var ct=[{path:"",component:De,children:[{path:"login",component:Se},{path:"",component:Se},{path:"role-selection",component:Ve},{path:"verify-otp",component:Me},{path:"register",component:Ae,canActivate:[Ee]},{path:"verify-forgot-password",component:Le},{path:"forgot-password",component:je,canActivate:[Ee]}]}],Ge=(()=>{class r{static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275mod=ie({type:r})}static{this.\u0275inj=te({imports:[we.forChild(ct),we]})}}return r})();var ni=(()=>{class r{static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275mod=ie({type:r})}static{this.\u0275inj=te({imports:[Te,Ge]})}}return r})();export{ni as AnonymousModule};
