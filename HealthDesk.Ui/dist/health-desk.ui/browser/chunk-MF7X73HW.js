import{a as H}from"./chunk-RCWZV2CG.js";import{a as le}from"./chunk-4XLCBABB.js";import{$b as re,Aa as C,Ac as se,B as we,Ca as m,Cc as M,Da as v,H as W,Hc as N,I as ee,Ic as A,Jc as U,K as J,Kc as j,Lc as L,M as b,Mb as q,N as te,Nb as Ce,Oa as n,Ob as _,Pa as G,Pb as he,Qa as S,Ra as Se,Sb as Ee,T as y,Tb as ke,U as w,Xb as k,Yb as oe,Yc as me,Zb as P,_b as x,_c as Pe,ca as l,da as p,dc as I,fc as g,gc as F,ha as h,hc as T,kc as ne,la as $,ma as c,mc as V,nb as ie,o as Q,ob as E,qc as R,sc as ae,tc as O,v as X,va as i,wa as r,xa as u,yb as xe,zc as B}from"./chunk-KXAHTZYI.js";import"./chunk-H5ORMA4Q.js";function je(o,f){o&1&&(i(0,"mat-error"),n(1,"Username is required"),r())}function Le(o,f){o&1&&(i(0,"mat-error"),n(1,"Password is required"),r())}var ve=(()=>{class o{constructor(t,s,e,a){this.fb=t,this.router=s,this.authService=e,this.notificationService=a,this.hide=!0,this.errorMessage=""}ngOnInit(){this.loginForm=this.fb.group({username:["",g.required],password:["",g.required]})}getControl(t){return this.loginForm.get(t)}onSubmit(){if(this.loginForm.valid){let{username:t,password:s}=this.loginForm.value;this.authService.login(t,s).subscribe({next:e=>{e.role==="admin"?this.router.navigate(["/admin"]):e.role!=="physician"&&e.role!=="patient"?e.status!=="Approved"?this.router.navigate(["/account"]):this.router.navigate([`organization/${e.role}`]):this.router.navigate([`/${e.role}`])},error:e=>{this.notificationService.showError("Incorrect username or password. Please try again.")}})}}navigateToSignup(){this.router.navigate(["/role-selection"])}navigateVerifyPassword(){this.router.navigate(["/verify-forgot-password"])}onEnterKey(){this.onSubmit()}static{this.\u0275fac=function(s){return new(s||o)(p(M),p(_),p(ke),p(P))}}static{this.\u0275cmp=b({type:o,selectors:[["app-login"]],decls:41,vars:6,consts:[[1,"capsule-container"],[1,"logo-container"],[1,"logo-animated"],[3,"ngSubmit","formGroup"],[1,"form-row"],["appearance","outline",1,"full-width"],["matInput","","formControlName","username","required","","type","text","placeholder","Enter username",3,"keydown.enter"],[4,"ngIf"],["matInput","","formControlName","password","required","","placeholder","Enter password",3,"keydown.enter","type"],["mat-icon-button","","matSuffix","",1,"m-1","cursor-pointer",3,"click"],["mat-raised-button","","type","submit",1,"custom-primary","full-width","login-button"],[1,"divider"],[1,"auth-options"],[1,"signup-text"],[1,"cursor-pointer",3,"click"]],template:function(s,e){if(s&1&&(i(0,"div",0)(1,"div",1),u(2,"div",2),i(3,"h2"),n(4,"HealthDesk"),r()(),i(5,"form",3),m("ngSubmit",function(){return e.onSubmit()}),i(6,"div",4)(7,"mat-form-field",5)(8,"mat-label"),n(9,"Username"),r(),i(10,"input",6),m("keydown.enter",function(){return e.onEnterKey()}),r(),h(11,je,2,0,"mat-error",7),r()(),i(12,"div",4)(13,"mat-form-field",5)(14,"mat-label"),n(15,"Password"),r(),i(16,"input",8),m("keydown.enter",function(){return e.onEnterKey()}),r(),i(17,"div",9),m("click",function(){return e.hide=!e.hide}),i(18,"mat-icon"),n(19),r()(),h(20,Le,2,0,"mat-error",7),r()(),i(21,"button",10),n(22,"Login"),r(),i(23,"div",11),n(24,"or"),r(),i(25,"div",12)(26,"p",13),n(27," Don't have an account ? "),i(28,"a",14),m("click",function(){return e.navigateToSignup()}),i(29,"mat-icon"),n(30,"person_add"),r(),i(31,"b")(32,"u"),n(33,"Register"),r()()()(),i(34,"p",13)(35,"a",14),m("click",function(){return e.navigateVerifyPassword()}),i(36,"mat-icon"),n(37,"lock_open"),r(),i(38,"b")(39,"u"),n(40,"Forgot Password?"),r()()()()()()()),s&2){let a,d;l(5),c("formGroup",e.loginForm),l(6),c("ngIf",((a=e.getControl("username"))==null?null:a.invalid)&&((a=e.getControl("username"))==null?null:a.touched)),l(5),c("type",e.hide?"password":"text"),l(),$("aria-label","Show password"),l(2),G(e.hide?"visibility_off":"visibility"),l(),c("ngIf",((d=e.getControl("password"))==null?null:d.invalid)&&((d=e.getControl("password"))==null?null:d.touched))}},dependencies:[E,V,I,F,T,B,R,O,x,k,j,N,A,U,L]})}}return o})();var Ie=(()=>{class o{constructor(t){this.router=t}selectRole(t){this.router.navigate(["/verify-otp"],{queryParams:{role:t}})}navigateToLogin(){this.router.navigate(["/login"])}navigateVerifyPassword(){this.router.navigate(["/verify-forgot-password"])}static{this.\u0275fac=function(s){return new(s||o)(p(_))}}static{this.\u0275cmp=b({type:o,selectors:[["app-role-select"]],decls:52,vars:0,consts:[[1,"capsule-container"],[1,"logo-container"],[1,"logo-animated"],[1,"page-header"],[1,"roles-container"],[1,"row"],[1,"role-tile","col","physician-img","m-1",3,"click"],["src","assets/physician.png","alt","Physician"],[1,"role-title"],[1,"role-tile","col","m-1",3,"click"],["src","assets/patient.png","alt","Patient"],["src","assets/hospital.png","alt","Hospital"],["src","assets/lab.png","alt","Laboratory"],["src","assets/neutra.png","alt","Pharmacy"],["src","assets/pharma.png","alt","Pharmaceutical"],[1,"divider"],[1,"auth-options"],[1,"signup-text"],[1,"signup-link","cursor-pointer",3,"click"],[1,"cursor-pointer",3,"click"]],template:function(s,e){s&1&&(i(0,"div",0)(1,"div",1),u(2,"div",2),i(3,"h2"),n(4,"HealthDesk"),r()(),i(5,"h3",3),n(6,"Select Your Role"),r(),i(7,"div",4)(8,"div",5)(9,"div",6),m("click",function(){return e.selectRole("Physician")}),u(10,"img",7),i(11,"div",8),n(12,"Physician"),r()(),i(13,"div",9),m("click",function(){return e.selectRole("Patient")}),u(14,"img",10),i(15,"div",8),n(16,"Patient"),r()(),i(17,"div",9),m("click",function(){return e.selectRole("Hospital")}),u(18,"img",11),i(19,"div",8),n(20,"Hospital"),r()()(),i(21,"div",5)(22,"div",9),m("click",function(){return e.selectRole("Laboratory")}),u(23,"img",12),i(24,"div",8),n(25,"Laboratory"),r()(),i(26,"div",9),m("click",function(){return e.selectRole("Pharmacy")}),u(27,"img",13),i(28,"div",8),n(29,"Pharmacy"),r()(),i(30,"div",9),m("click",function(){return e.selectRole("Pharmaceutical")}),u(31,"img",14),i(32,"div",8),n(33,"Pharmaceutical Co."),r()()()(),i(34,"div",15),n(35,"or"),r(),i(36,"div",16)(37,"p",17),n(38," Already have an account? "),i(39,"a",18),m("click",function(){return e.navigateToLogin()}),i(40,"mat-icon"),n(41,"person_add"),r(),i(42,"b")(43,"u"),n(44,"Login"),r()()()(),i(45,"p",17)(46,"a",19),m("click",function(){return e.navigateVerifyPassword()}),i(47,"mat-icon"),n(48,"lock_open"),r(),i(49,"b")(50,"u"),n(51,"Forgot Password ?"),r()()()()()())},dependencies:[x]})}}return o})();function qe(o,f){if(o&1&&(i(0,"mat-error"),n(1),r()),o&2){let t=v();l(),S(" ",t.selectedRole==="Physician"||t.selectedRole==="Patient"?"Please enter a valid mobile number":"Please enter a valid email"," ")}}function ze(o,f){if(o&1){let t=C();i(0,"div",17)(1,"re-captcha",18),m("resolved",function(e){y(t);let a=v();return w(a.onCaptchaResolved(e))}),r()()}}function Ke(o,f){if(o&1&&(i(0,"div",19)(1,"span",20),n(2),r()()),o&2){let t=v();l(2),S("Resend OTP in ",t.countdown," seconds")}}function $e(o,f){if(o&1){let t=C();i(0,"input",26),m("keyup",function(e){let a=y(t).index,d=v(2);return w(d.moveToNext(e,a))})("keydown.enter",function(){y(t);let e=v(2);return w(e.onEnterKey())}),r()}if(o&2){let t=f.index;c("formControlName",t)}}function Be(o,f){if(o&1){let t=C();i(0,"div",21)(1,"h4",22),n(2,"Enter OTP"),r(),i(3,"div",23),h(4,$e,1,1,"input",24),r(),i(5,"button",25),m("click",function(){y(t);let e=v();return w(e.verifyOtp())}),n(6,"Verify OTP"),r()()}if(o&2){let t=v();c("formGroup",t.verifyOtpForm),l(4),c("ngForOf",t.otpControls.controls),l(),c("disabled",!t.areAllOtpFilled())}}var Te=(()=>{class o{constructor(t,s,e,a,d,K){this.fb=t,this.router=s,this.otpService=e,this.authStateService=a,this.notificationService=d,this.route=K,this.isOtpSent=!1,this.isResendAvailable=!1,this.countdown=60,this.selectedRole="",this.captchaVerified=!1,this.otpToken="",this.isEmail=!1}ngOnInit(){this.route.queryParams.subscribe(t=>{this.selectedRole=t.role||null}),this.verifyOtpForm=this.fb.group({contact:["",this.getContactValidator()],otp:this.fb.array(new Array(6).fill("").map(()=>new ne("",g.required)))})}get otpControls(){return this.verifyOtpForm.get("otp")}getContactValidator(){return this.selectedRole==="Physician"||this.selectedRole==="Patient"?[g.required,g.pattern(/^(\+91[-\s]?)?[0]?(91)?[789]\d{9}$/)]:[g.required,g.email]}onCaptchaResolved(t){this.captchaVerified=!!t}getControl(t){return this.verifyOtpForm.get(t)}sendOtp(){this.isEmail=!(this.selectedRole==="Physician"||this.selectedRole==="Patient"),this.verifyOtpForm.get("contact")?.value&&this.captchaVerified&&this.otpService.sendOtp(this.verifyOtpForm.get("contact")?.value,this.isEmail).subscribe({next:t=>{this.notificationService.showSuccess("OTP Sent successfully"),this.otpToken=t.otpToken,this.isOtpSent=!0,this.startCountdown()},error:t=>{t.error?this.notificationService.showError(t.error):this.notificationService.showError("OTP sending failed. Try again after sometime.")}})}startCountdown(){this.isResendAvailable=!1,this.countdown=60,this.countdownSubscription=Q(1e3).pipe(X(this.countdown)).subscribe({next:t=>{this.countdown=60-t-1},complete:()=>{this.isResendAvailable=!0}})}resendOtp(){this.isResendAvailable&&this.sendOtp()}verifyOtp(){let t=this.verifyOtpForm.get("contact")?.value,s=this.otpControls.value.join("");this.otpService.verifyOtp(t,s,this.otpToken).subscribe({next:e=>{e.valid?(this.authStateService.setOtpVerified(!0),this.router.navigate(["/register"],{queryParams:{role:this.selectedRole,contact:this.verifyOtpForm.get("contact")?.value,isEmail:this.isEmail}})):this.notificationService.showError("Invalid OTP")},error:e=>{e.error?this.notificationService.showError(e.error):this.notificationService.showError("OTP verification failed. Try again after sometime.")}})}ngOnDestroy(){this.countdownSubscription&&this.countdownSubscription.unsubscribe()}navigateToLogin(){this.router.navigate(["/login"])}navigateVerifyPassword(){this.router.navigate(["/verify-forgot-password"])}moveToNext(t,s){let e=t.target;if(t.key>="0"&&t.key<="9"){let a=e.nextElementSibling;a&&a.focus()}if(t.key==="Backspace"){let a=e.previousElementSibling;a&&a.focus()}}areAllOtpFilled(){return this.otpControls.controls.every(t=>t.value.trim()!=="")}onEnterKey(){this.areAllOtpFilled()&&this.verifyOtp()}static{this.\u0275fac=function(s){return new(s||o)(p(M),p(_),p(le),p(H),p(P),p(q))}}static{this.\u0275cmp=b({type:o,selectors:[["app-verify-otp"]],decls:36,vars:11,consts:[[1,"capsule-container"],[1,"logo-container"],[1,"logo-animated"],[1,"page-header"],[3,"ngSubmit","formGroup"],["appearance","outline",1,"full-width"],["matInput","","formControlName","contact",3,"placeholder"],[4,"ngIf"],["class","captcha-container",4,"ngIf"],["class","resend-otp-message",4,"ngIf"],["mat-raised-button","","color","primary","type","submit",1,"full-width","login-button","m-3",3,"disabled"],["class","otp-section",3,"formGroup",4,"ngIf"],[1,"divider"],[1,"auth-options"],[1,"signup-text"],[1,"signup-link","cursor-pointer",3,"click"],[1,"cursor-pointer",3,"click"],[1,"captcha-container"],["siteKey","6LeLvHIqAAAAAJJVlNmel7PIIAdvQ1Gw3JeaXSMP",3,"resolved"],[1,"resend-otp-message"],[1,"resend-countdown"],[1,"otp-section",3,"formGroup"],[1,"otp-title"],["formArrayName","otp",1,"otp-inputs"],["maxlength","1","class","otp-input",3,"formControlName","keyup","keydown.enter",4,"ngFor","ngForOf"],["mat-raised-button","","color","primary",1,"full-width","login-button","m-2",3,"click","disabled"],["maxlength","1",1,"otp-input",3,"keyup","keydown.enter","formControlName"]],template:function(s,e){if(s&1&&(i(0,"div",0)(1,"div",1),u(2,"div",2),i(3,"h2",3),n(4,"HealthDesk"),r()(),i(5,"h4",3),n(6),r(),i(7,"form",4),m("ngSubmit",function(){return e.sendOtp()}),i(8,"mat-form-field",5)(9,"mat-label"),n(10),r(),u(11,"input",6),h(12,qe,2,1,"mat-error",7),r(),h(13,ze,2,0,"div",8)(14,Ke,3,1,"div",9),i(15,"button",10),n(16),r()(),h(17,Be,7,3,"div",11),i(18,"div",12),n(19,"or"),r(),i(20,"div",13)(21,"p",14),n(22," Already have an account ? "),i(23,"a",15),m("click",function(){return e.navigateToLogin()}),i(24,"mat-icon"),n(25,"person_add"),r(),i(26,"b")(27,"u"),n(28,"Login"),r()()()(),i(29,"p",14)(30,"a",16),m("click",function(){return e.navigateVerifyPassword()}),i(31,"mat-icon"),n(32,"lock_open"),r(),i(33,"b")(34,"u"),n(35,"Forgot Password ?"),r()()()()()()),s&2){let a;l(6),Se("Verify Your ",e.selectedRole==="Physician"||e.selectedRole==="Patient"?"Mobile Number":"Email"," for ",e.selectedRole,""),l(),c("formGroup",e.verifyOtpForm),l(3),G(e.selectedRole==="Physician"||e.selectedRole==="Patient"?"Mobile Number":"Email"),l(),c("placeholder",e.selectedRole==="Physician"||e.selectedRole==="Patient"?"Enter Mobile Number":"Enter Email"),l(),c("ngIf",((a=e.getControl("contact"))==null?null:a.invalid)&&((a=e.verifyOtpForm.get("contact"))==null?null:a.touched)),l(),c("ngIf",!e.isOtpSent),l(),c("ngIf",e.isOtpSent&&!e.isResendAvailable),l(),c("disabled",!e.captchaVerified||e.isOtpSent&&!e.isResendAvailable),l(),S(" ",e.isOtpSent?"Resend OTP":"Send OTP"," "),l(),c("ngIf",e.isOtpSent)}},dependencies:[ie,E,V,I,F,T,se,R,O,ae,me,x,k,j,N,A,L]})}}return o})();var _e=function(o){return o[o.Patient=2]="Patient",o[o.Physician=1]="Physician",o[o.Admin=3]="Admin",o[o.Hospital=4]="Hospital",o[o.Laboratory=5]="Laboratory",o[o.Pharmaceutical=6]="Pharmaceutical",o[o.Nutraceutical=7]="Nutraceutical",o}(_e||{});function Ve(o){let f=o.charAt(0).toUpperCase()+o.slice(1).toLowerCase();if(_e[f]!==void 0)return _e[f]}var Y=(()=>{class o{constructor(t){this.http=t,this.apiUrl=Ee.apiUrl+"/user"}register(t){return this.http.post(`${this.apiUrl}/register`,t)}resetPassword(t,s,e){return this.http.post(`${this.apiUrl}/reset-password`,{contact:t,newPassword:s,isEmail:e})}getUsername(t){return this.http.get(`${this.apiUrl}/get-username/${t}`,{withCredentials:!0})}static{this.\u0275fac=function(s){return new(s||o)(J(xe))}}static{this.\u0275prov=W({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();function He(o,f){if(o&1){let t=C();i(0,"mat-form-field",6)(1,"mat-label"),n(2,"Mobile Number"),r(),i(3,"input",23),m("keydown.enter",function(){y(t);let e=v();return w(e.onEnterKey())}),r()()}}function Ye(o,f){if(o&1){let t=C();i(0,"mat-form-field",6)(1,"mat-label"),n(2,"Email"),r(),i(3,"input",24),m("keydown.enter",function(){y(t);let e=v();return w(e.onEnterKey())}),r()()}}function Je(o,f){o&1&&(i(0,"mat-error"),n(1),r()),o&2&&(l(),S(" ","Please enter a valid username"," "))}function Ze(o,f){o&1&&(i(0,"mat-error"),n(1),r()),o&2&&(l(),S(" ","Please enter a valid password"," "))}function Qe(o,f){o&1&&(i(0,"mat-error"),n(1," Passwords do not match "),r())}var Re=(()=>{class o{constructor(t,s,e,a,d){this.fb=t,this.router=s,this.userService=e,this.notificationService=a,this.route=d,this.selectedRole="",this.prefilledMobile="",this.prefilledEmail="",this.hide=!0}ngOnInit(){this.route.queryParams.subscribe(t=>{this.selectedRole=t.role||null,t.isEmail==="true"?this.prefilledEmail=t.contact:this.prefilledMobile=t.contact}),this.registerForm=this.fb.group({role:[{value:this.selectedRole,disabled:!0}],mobile:[{value:this.prefilledMobile,disabled:!0}],email:[{value:this.prefilledEmail,disabled:!0}],username:["",[g.required,g.pattern(/^[a-zA-Z0-9.@]{5,15}$/)]],password:["",[g.required,g.pattern(/^[a-zA-Z0-9_@.$&*-]{6,}$/)]],confirmPassword:["",g.required]})}isPasswordMatch(){return this.registerForm.get("password")?.value===this.registerForm.get("confirmPassword")?.value}getControl(t){return this.registerForm.get(t)}onSubmit(){if(this.registerForm.valid&&this.isPasswordMatch()){var t=Ve(this.selectedRole);let s={username:this.registerForm.get("username")?.value,password:this.registerForm.get("password")?.value,email:this.prefilledEmail,mobile:this.prefilledMobile,roleId:t};this.userService.register(s).subscribe({next:()=>{this.notificationService.showSuccess("Registration successful. Redirecting to login..."),setTimeout(()=>{this.router.navigate(["/login"])},3e3)},error:e=>{e.error?this.notificationService.showError(e.error):this.notificationService.showError("Registration failed. Please try again.")}})}else this.isPasswordMatch()||this.notificationService.showError("Passwords do not match.")}onClear(){this.registerForm.reset({role:{value:this.selectedRole,disabled:!0},mobile:{value:this.prefilledMobile,disabled:!!this.prefilledMobile},email:{value:this.prefilledEmail,disabled:!!this.prefilledEmail}})}navigateToLogin(){this.router.navigate(["/login"])}navigateVerifyPassword(){this.router.navigate(["/verify-forgot-password"])}onEnterKey(){this.onSubmit()}static{this.\u0275fac=function(s){return new(s||o)(p(M),p(_),p(Y),p(P),p(q))}}static{this.\u0275cmp=b({type:o,selectors:[["app-register"]],decls:60,vars:9,consts:[[1,"capsule-container"],[1,"logo-container"],[1,"logo-animated"],[1,"page-header"],[3,"ngSubmit","formGroup"],[1,"form-row"],["appearance","outline",1,"full-width"],["matInput","","formControlName","role","readonly","",1,"disabled-bold",3,"keydown.enter"],["appearance","outline","class","full-width",4,"ngIf"],["matInput","","formControlName","username","placeholder","Enter username",3,"keydown.enter"],["mat-icon-button","","matSuffix","","matTooltip","A lphanumeric bweteen 5 to 15 characters long and symbols (. @) allowed. "],[4,"ngIf"],["matInput","","formControlName","password","type","password","placeholder","Enter password",3,"keydown.enter"],["mat-icon-button","","matSuffix","","matTooltip","6+ characters, alphanumeric, and symbols (_@.$&*-)"],["matInput","","formControlName","confirmPassword","required","","placeholder","Confirm password",3,"keydown.enter","type"],["mat-icon-button","","matSuffix","",1,"m-1","cursor-pointer",3,"click"],[1,"button-container"],["mat-raised-button","","color","primary","type","submit"],["mat-raised-button","","color","warn","type","button",3,"click"],[1,"auth-options"],[1,"signup-text"],[1,"signup-link","cursor-pointer",3,"click"],[1,"cursor-pointer",3,"click"],["matInput","","formControlName","mobile","placeholder","Enter mobile number",3,"keydown.enter"],["matInput","","formControlName","email","placeholder","Enter email",3,"keydown.enter"]],template:function(s,e){if(s&1&&(i(0,"div",0)(1,"div",1),u(2,"div",2),r(),i(3,"h3",3),n(4,"Register"),r(),i(5,"form",4),m("ngSubmit",function(){return e.onSubmit()}),i(6,"div",5)(7,"mat-form-field",6)(8,"mat-label"),n(9,"Role *"),r(),i(10,"input",7),m("keydown.enter",function(){return e.onEnterKey()}),r()(),h(11,He,4,0,"mat-form-field",8)(12,Ye,4,0,"mat-form-field",8),r(),i(13,"div",5)(14,"mat-form-field",6)(15,"mat-label"),n(16,"Username"),r(),i(17,"input",9),m("keydown.enter",function(){return e.onEnterKey()}),r(),i(18,"button",10)(19,"mat-icon"),n(20,"info"),r()(),h(21,Je,2,1,"mat-error",11),r()(),i(22,"div",5)(23,"mat-form-field",6)(24,"mat-label"),n(25,"Password"),r(),i(26,"input",12),m("keydown.enter",function(){return e.onEnterKey()}),r(),i(27,"button",13)(28,"mat-icon"),n(29,"info"),r()(),h(30,Ze,2,1,"mat-error",11),r(),i(31,"mat-form-field",6)(32,"mat-label"),n(33,"Confirm Password"),r(),i(34,"input",14),m("keydown.enter",function(){return e.onEnterKey()}),r(),i(35,"div",15),m("click",function(){return e.hide=!e.hide}),i(36,"mat-icon"),n(37),r()(),h(38,Qe,2,0,"mat-error",11),r()(),i(39,"div",16)(40,"button",17),n(41,"Register"),r(),i(42,"button",18),m("click",function(){return e.onClear()}),n(43,"Clear"),r()()(),i(44,"div",19)(45,"p",20),n(46," Already have an account ? "),i(47,"a",21),m("click",function(){return e.navigateToLogin()}),i(48,"mat-icon"),n(49,"person_add"),r(),i(50,"b")(51,"u"),n(52,"Login"),r()()()(),i(53,"p",20)(54,"a",22),m("click",function(){return e.navigateVerifyPassword()}),i(55,"mat-icon"),n(56,"lock_open"),r(),i(57,"b")(58,"u"),n(59,"Forgot Password ?"),r()()()()()()),s&2){let a,d,K;l(5),c("formGroup",e.registerForm),l(6),c("ngIf",e.prefilledMobile),l(),c("ngIf",e.prefilledEmail),l(9),c("ngIf",((a=e.getControl("username"))==null?null:a.invalid)&&((a=e.getControl("username"))==null?null:a.touched)),l(9),c("ngIf",((d=e.getControl("password"))==null?null:d.invalid)&&((d=e.getControl("password"))==null?null:d.touched)),l(4),c("type",e.hide?"password":"text"),l(),$("aria-label","Show password"),l(2),G(e.hide?"visibility_off":"visibility"),l(),c("ngIf",!e.isPasswordMatch()&&((K=e.getControl("confirmPassword"))==null?null:K.touched))}},dependencies:[E,V,I,F,T,B,R,O,x,k,oe,re,j,N,A,U,L]})}}return o})();function Xe(o,f){o&1&&(i(0,"mat-error"),n(1),r()),o&2&&(l(),S(" ","Please enter a valid password"," "))}function We(o,f){o&1&&(i(0,"mat-error"),n(1," Passwords do not match "),r())}var Oe=(()=>{class o{constructor(t,s,e,a,d){this.fb=t,this.route=s,this.userService=e,this.router=a,this.notification=d,this.contactInfo="",this.isEmail=!1,this.hide=!0}ngOnInit(){this.route.queryParams.subscribe(t=>{this.isEmail=t.isEmail==="true",this.contactInfo=t.contact}),this.forgotPasswordForm=this.fb.group({contactInfo:[{value:this.contactInfo,disabled:!0}],password:["",[g.required,g.pattern(/^[a-zA-Z0-9_@.$&*-]{6,}$/)]],confirmPassword:["",g.required]})}getControl(t){return this.forgotPasswordForm.get(t)}onSubmit(){if(this.forgotPasswordForm.valid&&this.isPasswordMatch()){let t=this.forgotPasswordForm.get("password")?.value;this.userService.resetPassword(this.contactInfo,t,this.isEmail).subscribe({next:()=>{this.notification.showSuccess("Password successfully reset! Redirecting to login..."),setTimeout(()=>{this.router.navigate(["/login"])},3e3)},error:s=>{this.notification.showError(s.error.message||"Password reset failed. Please try again.")}})}}isPasswordMatch(){var t=this.forgotPasswordForm.get("password")?.value===this.forgotPasswordForm.get("confirmPassword")?.value;return t}static{this.\u0275fac=function(s){return new(s||o)(p(M),p(q),p(Y),p(_),p(P))}}static{this.\u0275cmp=b({type:o,selectors:[["app-forgot-password"]],decls:28,vars:7,consts:[[1,"capsule-container"],[1,"logo-container"],[1,"logo-animated"],[1,"page-header"],[3,"ngSubmit","formGroup"],["appearance","outline",1,"full-width"],["matInput","","formControlName","contactInfo","readonly",""],["matInput","","formControlName","password","type","password","placeholder","Enter password"],["mat-icon-button","","matSuffix","","matTooltip","6+ characters, alphanumeric, and symbols (_@.$&*-)"],[4,"ngIf"],["matInput","","formControlName","confirmPassword","required","","placeholder","Confirm password",3,"type"],["mat-icon-button","","matSuffix","",1,"m-1","cursor-pointer",3,"click"],["mat-raised-button","","color","primary","type","submit"]],template:function(s,e){if(s&1&&(i(0,"div",0)(1,"div",1),u(2,"div",2),i(3,"h2",3),n(4,"Reset Password"),r()(),i(5,"form",4),m("ngSubmit",function(){return e.onSubmit()}),i(6,"mat-form-field",5)(7,"mat-label"),n(8),r(),u(9,"input",6),r(),i(10,"mat-form-field",5)(11,"mat-label"),n(12,"Password"),r(),u(13,"input",7),i(14,"button",8)(15,"mat-icon"),n(16,"info"),r()(),h(17,Xe,2,1,"mat-error",9),r(),i(18,"mat-form-field",5)(19,"mat-label"),n(20,"Confirm Password"),r(),u(21,"input",10),i(22,"div",11),m("click",function(){return e.hide=!e.hide}),i(23,"mat-icon"),n(24),r()(),h(25,We,2,0,"mat-error",9),r(),i(26,"button",12),n(27,"Reset Password"),r()()()),s&2){let a,d;l(5),c("formGroup",e.forgotPasswordForm),l(3),G(e.isEmail?"Email Id":"Mobile Number"),l(9),c("ngIf",((a=e.getControl("password"))==null?null:a.invalid)&&((a=e.getControl("password"))==null?null:a.touched)),l(4),c("type",e.hide?"password":"text"),l(),$("aria-label","Show password"),l(2),G(e.hide?"visibility_off":"visibility"),l(),c("ngIf",!e.isPasswordMatch()&&((d=e.getControl("confirmPassword"))==null?null:d.touched))}},dependencies:[E,V,I,F,T,B,R,O,x,k,oe,re,j,N,A,U,L]})}}return o})();var ye=(()=>{class o{constructor(t,s){this.authStateService=t,this.router=s}canActivate(t,s){if(this.authStateService.isOtpVerified())return!0;{let e=s.url.includes("forgot-password")?"/verify-forgot-password":"/verify-otp";return this.router.navigate([e]),!1}}static{this.\u0275fac=function(s){return new(s||o)(J(H),J(_))}}static{this.\u0275prov=W({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();function et(o,f){o&1&&(i(0,"mat-error"),n(1," Please enter a valid mobile number "),r())}function tt(o,f){o&1&&(i(0,"mat-error"),n(1," Please enter a valid mobile number "),r())}function it(o,f){if(o&1){let t=C();i(0,"div",19)(1,"re-captcha",20),m("resolved",function(e){y(t);let a=v();return w(a.onCaptchaResolved(e))}),r()()}}function ot(o,f){if(o&1&&(i(0,"div",21)(1,"span",22),n(2),r()()),o&2){let t=v();l(2),S("Resend OTP in ",t.countdown," seconds")}}function rt(o,f){if(o&1){let t=C();i(0,"input",28),m("keyup",function(e){let a=y(t).index,d=v(2);return w(d.moveToNext(e,a))})("keydown.enter",function(){y(t);let e=v(2);return w(e.onEnterKey())}),r()}if(o&2){let t=f.index;c("formControlName",t)}}function nt(o,f){if(o&1){let t=C();i(0,"div",23)(1,"h4",24),n(2,"Enter OTP"),r(),i(3,"div",25),h(4,rt,1,1,"input",26),r(),i(5,"button",27),m("click",function(){y(t);let e=v();return w(e.verifyOtp())}),n(6,"Verify OTP"),r()()}if(o&2){let t=v();c("formGroup",t.verifyForm),l(4),c("ngForOf",t.otpControls.controls),l(),c("disabled",!t.areAllOtpFilled())}}var Me=(()=>{class o{constructor(t,s,e,a,d,K){this.fb=t,this.router=s,this.otpService=e,this.authStateService=a,this.notificationService=d,this.userService=K,this.isOtpSent=!1,this.isResendAvailable=!1,this.countdown=60,this.captchaVerified=!1,this.otpToken=""}ngOnInit(){this.verifyForm=this.fb.group({email:["",[g.email]],mobile:["",[g.pattern(/^(\+91[-\s]?)?[0]?(91)?[789]\d{9}$/)]],otp:this.fb.array(new Array(6).fill("").map(()=>new ne("",g.required)))})}getControl(t){return this.verifyForm.get(t)}get otpControls(){return this.verifyForm.get("otp")}onCaptchaResolved(t){this.captchaVerified=!!t}sendOtp(){var t=!!this.verifyForm.get("email")?.value;if(this.captchaVerified&&(this.verifyForm.get("mobile")?.value||this.verifyForm.get("email")?.value)){let s="";t?s=this.verifyForm.get("email")?.value:s=this.verifyForm.get("mobile")?.value,this.userService.getUsername(s).pipe(we(e=>this.otpService.sendOtp(s,t))).subscribe({next:e=>{this.notificationService.showSuccess("OTP sent successfully"),this.otpToken=e.otpToken,this.isOtpSent=!0,this.startCountdown()},error:e=>{e.status===404?this.notificationService.showError("Not registered with app. Please Register"):(console.error("Failed to send OTP",e),this.notificationService.showError("Failed to send OTP. Please try again"))}})}else this.notificationService.showError("Please verify the captcha and provide a valid contact.")}startCountdown(){this.isResendAvailable=!1,this.countdown=60,this.countdownSubscription=Q(1e3).pipe(X(this.countdown)).subscribe({next:t=>{this.countdown=60-t-1},complete:()=>{this.isResendAvailable=!0}})}resendOtp(){this.isResendAvailable&&this.sendOtp()}verifyOtp(){var t=!!this.verifyForm.get("email")?.value,s="";t?s=this.verifyForm.get("email")?.value:s=this.verifyForm.get("mobile")?.value;let e=this.otpControls.value.join("");this.otpService.verifyOtp(s,e,this.otpToken).subscribe({next:a=>{a.valid?(this.authStateService.setOtpVerified(!0),this.router.navigate(["/forgot-password"],{queryParams:{contact:s,isEmail:t}})):this.notificationService.showError("Invalid OTP. Please try again.")},error:a=>{console.error("OTP verification failed",a),this.notificationService.showError("OTP verification failed. Please try again.")}})}ngOnDestroy(){this.countdownSubscription&&this.countdownSubscription.unsubscribe()}navigateToLogin(){this.router.navigate(["/login"])}navigateToSignup(){this.router.navigate(["/role-selection"])}moveToNext(t,s){let e=t.target;if(t.key>="0"&&t.key<="9"){let a=e.nextElementSibling;a&&a.focus()}if(t.key==="Backspace"){let a=e.previousElementSibling;a&&a.focus()}}areAllOtpFilled(){return this.otpControls.controls.every(t=>t.value.trim()!=="")}onEnterKey(){this.areAllOtpFilled()&&this.verifyOtp()}static{this.\u0275fac=function(s){return new(s||o)(p(M),p(_),p(le),p(H),p(P),p(Y))}}static{this.\u0275cmp=b({type:o,selectors:[["app-verify-forgot-password"]],decls:45,vars:8,consts:[[1,"capsule-container"],[1,"logo-container"],[1,"logo-animated"],[1,"page-header"],[3,"ngSubmit","formGroup"],[1,"form-row"],["appearance","outline",1,"full-width"],["matInput","","formControlName","mobile","placeholder","Enter Mobile Number"],[4,"ngIf"],[1,"divider"],["matInput","","formControlName","email","placeholder","Enter Email"],["class","captcha-container",4,"ngIf"],["class","resend-otp-message",4,"ngIf"],["mat-raised-button","","color","primary","type","submit",1,"full-width","login-button","m-3",3,"disabled"],["class","otp-section",3,"formGroup",4,"ngIf"],[1,"auth-options"],[1,"signup-text"],[1,"signup-link","cursor-pointer",3,"click"],[1,"cursor-pointer",3,"click"],[1,"captcha-container"],["siteKey","6LeLvHIqAAAAAJJVlNmel7PIIAdvQ1Gw3JeaXSMP",3,"resolved"],[1,"resend-otp-message"],[1,"resend-countdown"],[1,"otp-section",3,"formGroup"],[1,"otp-title"],["formArrayName","otp",1,"otp-inputs"],["maxlength","1","class","otp-input",3,"formControlName","keyup","keydown.enter",4,"ngFor","ngForOf"],["mat-raised-button","","color","primary",1,"full-width","login-button","m-2",3,"click","disabled"],["maxlength","1",1,"otp-input",3,"keyup","keydown.enter","formControlName"]],template:function(s,e){if(s&1&&(i(0,"div",0)(1,"div",1),u(2,"div",2),i(3,"h2",3),n(4,"HealthDesk"),r()(),i(5,"h3",3),n(6,"Verify Contact"),r(),i(7,"form",4),m("ngSubmit",function(){return e.sendOtp()}),i(8,"div",5)(9,"mat-form-field",6)(10,"mat-label"),n(11," Mobile Number"),r(),u(12,"input",7),h(13,et,2,0,"mat-error",8),r()(),i(14,"div",9),n(15,"or"),r(),i(16,"div",5)(17,"mat-form-field",6)(18,"mat-label"),n(19," Email"),r(),u(20,"input",10),h(21,tt,2,0,"mat-error",8),r()(),h(22,it,2,0,"div",11)(23,ot,3,1,"div",12),i(24,"button",13),n(25),r()(),h(26,nt,7,3,"div",14),i(27,"div",9),n(28,"or"),r(),i(29,"div",15)(30,"p",16),n(31," Don't have an account? "),i(32,"a",17),m("click",function(){return e.navigateToSignup()}),i(33,"mat-icon"),n(34,"person_add"),r(),i(35,"b")(36,"u"),n(37,"Register"),r()()()(),i(38,"p",16)(39,"a",18),m("click",function(){return e.navigateToLogin()}),i(40,"mat-icon"),n(41,"person_add"),r(),i(42,"b")(43,"u"),n(44,"Login ?"),r()()()()()()),s&2){let a,d;l(7),c("formGroup",e.verifyForm),l(6),c("ngIf",((a=e.getControl("mobile"))==null?null:a.invalid)&&((a=e.getControl("mobile"))==null?null:a.touched)),l(8),c("ngIf",((d=e.getControl("email"))==null?null:d.invalid)&&((d=e.getControl("email"))==null?null:d.touched)),l(),c("ngIf",!e.isOtpSent),l(),c("ngIf",e.isOtpSent&&!e.isResendAvailable),l(),c("disabled",!e.captchaVerified||e.isOtpSent&&!e.isResendAvailable),l(),S(" ",e.isOtpSent?"Resend OTP":"Send OTP"," "),l(),c("ngIf",e.isOtpSent)}},dependencies:[ie,E,V,I,F,T,se,R,O,ae,me,x,k,j,N,A,L]})}}return o})();var Ne=(()=>{class o{constructor(t,s){this.router=t,this.route=s,this.showSidebar=!0}ngOnInit(){}static{this.\u0275fac=function(s){return new(s||o)(p(_),p(q))}}static{this.\u0275cmp=b({type:o,selectors:[["app-anonymous"]],decls:1,vars:0,template:function(s,e){s&1&&u(0,"router-outlet")},dependencies:[Ce],styles:[`body{background:linear-gradient(to right,#e22cdc,#63b4ee,#2cbf5d);animation:gradientAnimation 10s ease infinite;font-family:Roboto,sans-serif;color:#fff;background-size:200% 200%}@keyframes gradientAnimation{0%{background-position:0% 50%}50%{background-position:100% 50%}to{background-position:0% 50%}}.mat-primary{color:#d76745bc}.mat-accent{color:#2cbf5d}.mat-button{color:#2cbf5d;font-weight:700;transition:transform .3s ease,color .3s ease}.mat-button:hover{transform:scale(1.05);color:#d76745bc}.btn-custom{background-color:#d76745bc;border:none;color:#fff;padding:10px 20px;transition:all .3s ease}.btn-custom:hover{background-color:#2cbf5d;transform:scale(1.1);box-shadow:0 4px 15px #0003}.card-custom{background-color:#ffffff1a;border-radius:10px;padding:20px;box-shadow:0 4px 20px #0000001a;transition:transform .4s ease,box-shadow .4s ease}.card-custom:hover{transform:translateY(-10px);box-shadow:0 8px 25px #0000004d}.capsule-container{max-width:360px;max-height:100vh;background-color:#ffffffe6;border-radius:50px;padding:30px;box-shadow:0 10px 20px #0000004d;text-align:center;margin:1% auto auto;display:flex;flex-direction:column;overflow-y:auto;overflow-x:hidden;box-sizing:border-box}.capsule-container::-webkit-scrollbar{width:6px}.capsule-container::-webkit-scrollbar-thumb{background-color:#bb7fbb;border-radius:4px}.capsule-container::-webkit-scrollbar-track{background:transparent}.logo-animated{width:100px;height:100px;margin:0 auto 10px;border-radius:50%;background-image:url("./media/logo-P7TD5553.png");background-size:cover}@keyframes rotate{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.logo-container h2{font-size:2rem;font-weight:700;background:linear-gradient(45deg,#673ab7,#03a9f4,#4caf50);-webkit-background-clip:text;color:transparent;animation:gradient-animation 4s ease-in-out infinite}@keyframes gradient-animation{0%{background-position:0%}to{background-position:100%}}mat-form-field,button,.divider{width:100%;transition:all .3s ease}::ng-deep mat-form-field.mat-form-field-appearance-outline .mat-form-field-outline-thick{border-color:#66bb6a;transition:border-color .3s ease}::ng-deep mat-form-field.mat-form-field-appearance-outline .mat-form-field-outline-thick.mat-focused{border-color:#673ab7;transition:border-color .4s ease}button.login-button{font-size:1rem;padding:10px;transition:transform .3s ease,box-shadow .3s ease}button.login-button:hover{transform:scale(1.05);box-shadow:0 4px 15px #0003}.divider{font-weight:700;color:#333;margin:20px 0;display:flex;align-items:center;position:relative}.divider:before,.divider:after{content:"";flex:1;height:1px;background:#333;margin:0 8px}.auth-options{text-align:center;font-size:.9rem}.auth-options .signup-text{display:flex;justify-content:center;align-items:center;margin:5px 0;color:#7217d4;font-weight:bolder}.auth-options a{display:inline-flex;align-items:center;color:#673ab7;font-weight:600;text-decoration:none;transition:color .3s ease,transform .3s ease;font-size:.9rem}.auth-options a:hover{color:#3f51b5;transform:translateY(-2px)}.auth-options a mat-icon{font-size:1rem;margin-right:5px;vertical-align:middle;transition:transform .3s ease}.roles-container{display:flex;flex-direction:column;gap:20px}.roles-container .role-tile{width:85px;height:85px;background:#fffc;border-radius:15px;box-shadow:0 4px 10px #0003;overflow:hidden;display:flex;align-items:center;justify-content:center;transition:transform .3s ease,box-shadow .3s ease;position:relative;cursor:pointer}.roles-container .role-tile img{width:80%;height:auto;transition:opacity .3s ease}.roles-container .role-tile:hover{transform:scale(1.05);box-shadow:0 4px 15px #0003}.roles-container .role-tile:hover img{opacity:.3}.roles-container .role-tile:hover .role-title{opacity:1;transform:translateY(0)}.roles-container .role-title{position:absolute;bottom:10px;text-align:center;color:#673ab7;font-weight:600;font-size:.65rem;opacity:0;transform:translateY(10px);transition:opacity .3s ease,transform .3s ease}.otp-section{margin-top:20px}.button-container{display:flex;justify-content:space-between;margin-top:20px}.otp-input{width:40px;height:40px;text-align:center;font-size:1.5rem;border-radius:5px;border:2px solid #4caf50;box-shadow:0 4px 8px #4caf504d;transition:transform .3s ease,box-shadow .3s ease;margin-bottom:5px}.otp-input:focus{outline:none;transform:scale(1.1);box-shadow:0 6px 12px #4caf5066;border-color:#388e3c}.success-snackbar{background-color:#4caf50!important;color:#fff}.error-snackbar{background-color:#f44336!important;color:#fff}.captcha-container{margin-bottom:15px}.resend-otp-message{color:#4caf50;font-size:.9rem;margin-bottom:10px}.otp-title{color:#4caf50;font-weight:700;font-size:1.2rem;margin-top:20px}.cursor-pointer{cursor:pointer}.page-header{font-size:2.5rem;font-weight:600;font-family:Roboto,sans-serif;text-align:center;margin-bottom:20px;color:transparent;background:linear-gradient(to right,#e22cdc,#63b4ee,#2cbf5d);-webkit-background-clip:text;background-clip:text;animation:fadeInTop 1s ease-out,gradientTextAnimation 10s ease infinite;background-size:200% 200%}@keyframes gradientTextAnimation{0%{background-position:0% 50%}50%{background-position:100% 50%}to{background-position:0% 50%}}@keyframes fadeInTop{0%{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}.disabled-bold{font-weight:700;color:#333;background-color:#f9f9f9;border:1px solid #ccc;pointer-events:none}
`],encapsulation:2})}}return o})();var at=[{path:"",component:Ne,children:[{path:"login",component:ve},{path:"",component:ve},{path:"role-selection",component:Ie},{path:"verify-otp",component:Te},{path:"register",component:Re,canActivate:[ye]},{path:"verify-forgot-password",component:Me},{path:"forgot-password",component:Oe,canActivate:[ye]}]}],Ae=(()=>{class o{static{this.\u0275fac=function(s){return new(s||o)}}static{this.\u0275mod=te({type:o})}static{this.\u0275inj=ee({imports:[he.forChild(at),he]})}}return o})();var ti=(()=>{class o{static{this.\u0275fac=function(s){return new(s||o)}}static{this.\u0275mod=te({type:o})}static{this.\u0275inj=ee({imports:[Pe,Ae]})}}return o})();export{ti as AnonymousModule};
